<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eden Consciousness Temple - Members Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg-primary: #0A0E27;
            --accent-purple: #8B5CF6;
            --accent-gold: #F59E0B;
            --accent-blue: #3B82F6;
            --accent-green: #10B981;
            --text-primary: #FFFFFF;
            --text-secondary: #A1A1AA;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0A0E27 0%, #1a1f3a 50%, #0A0E27 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .temple-3d {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1;
            pointer-events: none;
        }

        .modern-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            backdrop-filter: blur(20px);
            background: rgba(10, 14, 39, 0.8);
            border-bottom: 1px solid var(--glass-border);
            padding: 1.5rem 2rem;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, #F59E0B, #8B5CF6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .user-status {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.5rem 1rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-gold));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        .stats-mini {
            display: flex;
            gap: 1.5rem;
            font-size: 0.85rem;
        }

        .portal-container {
            max-width: 1400px;
            margin: 120px auto 4rem;
            padding: 0 2rem;
        }

        .portal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .portal-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 2.5rem 2rem;
            cursor: pointer;
            transition: all 0.4s;
            position: relative;
        }

        .portal-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-gold));
            opacity: 0;
            transition: opacity 0.3s;
        }

        .portal-card:hover {
            transform: translateY(-8px);
            border-color: rgba(139, 92, 246, 0.5);
            box-shadow: 0 20px 60px rgba(139, 92, 246, 0.3);
        }

        .portal-card:hover::before {
            opacity: 1;
        }

        .portal-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .portal-card h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .portal-card p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .chamber-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: var(--bg-primary);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s;
            overflow-y: auto;
        }

        .chamber-panel.open {
            opacity: 1;
            visibility: visible;
        }

        .chamber-wrapper {
            max-width: 900px;
            margin: 0 auto;
            padding: 6rem 2rem 4rem;
        }

        .chamber-header-modern {
            text-align: center;
            margin-bottom: 3rem;
            padding: 3rem 2rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
        }

        .chamber-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #F59E0B, #8B5CF6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .reflection-section {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .reflection-textarea {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1rem;
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            min-height: 120px;
            resize: vertical;
        }

        .btn-modern {
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-blue));
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(139, 92, 246, 0.4);
        }

        .btn-modern:active {
            transform: translateY(0);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--glass-border);
        }

        .close-btn {
            position: fixed;
            top: 1.5rem;
            right: 2rem;
            width: 48px;
            height: 48px;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 2100;
            font-size: 1.5rem;
        }

        @keyframes shimmer {
            100% { left: 100%; }
        }

        @media (max-width: 768px) {
            .portal-grid { grid-template-columns: 1fr; }
            .stats-mini { display: none; }
        }
    </style>
</head>
<body>
    <div class="animated-bg"></div>
    <div class="temple-3d" id="temple-3d"></div>

    <div class="modern-header">
        <div class="header-content">
            <div class="logo">üèõÔ∏è Eden Consciousness</div>
            <div class="user-status">
                <div class="stats-mini">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span>üìÖ</span>
                        <span id="header-enoch-date">Loading...</span>
                    </div>
                </div>
                <div class="user-info">
                    <div class="user-avatar">üôè</div>
                    <div style="font-weight: 600; font-size: 0.9rem;">Sacred Seeker</div>
                </div>
                <button class="btn-modern" id="music-btn" onclick="toggleBackgroundMusic()" style="padding: 0.5rem 1rem; font-size: 0.85rem;">üéµ Music</button>
            </div>
        </div>
    </div>

    <div class="portal-container" id="portal-container">
        <div style="text-align: center; margin-bottom: 3rem;">
            <h1 style="font-family: 'Playfair Display', serif; font-size: 3rem; font-weight: 700; margin-bottom: 1rem;">Choose Your Path</h1>
            <p style="color: var(--text-secondary); font-size: 1.1rem;" id="portal-subtitle">Loading sacred calendar...</p>
        </div>

        <div class="portal-grid">
            <div class="portal-card" onclick="openCalendar()">
                <div class="portal-icon">üìÖ</div>
                <h3>Sacred Calendar</h3>
                <p>Enoch Calendar with Hebrew months - Track your spiritual journey day by day.</p>
            </div>

            <div class="portal-card" onclick="alert('Coming soon!')">
                <div class="portal-icon">üèõÔ∏è</div>
                <h3>Sacred Chambers</h3>
                <p>Nine chambers of reflection and inner guidance.</p>
            </div>

            <div class="portal-card" onclick="alert('Coming soon!')">
                <div class="portal-icon">üéØ</div>
                <h3>Manifestation Board</h3>
                <p>Write your desires, track prayers, witness divine timing.</p>
            </div>

            <div class="portal-card" onclick="alert('Coming soon!')">
                <div class="portal-icon">üßò</div>
                <h3>Meditation Space</h3>
                <p>Guided meditation timer and mindfulness practice.</p>
            </div>

            <div class="portal-card" onclick="alert('Coming soon!')">
                <div class="portal-icon">üåô</div>
                <h3>Cosmic Timing</h3>
                <p>Track moon phases and align with celestial cycles.</p>
            </div>

            <div class="portal-card" onclick="alert('Coming soon!')">
                <div class="portal-icon">üìö</div>
                <h3>Sacred Library</h3>
                <p>Access the complete book and workbook.</p>
            </div>
        </div>
    </div>

    <!-- Calendar Panel -->
    <div class="chamber-panel" id="calendar-panel">
        <div class="close-btn" onclick="closePanel('calendar-panel')">‚úï</div>
        <div class="chamber-wrapper" style="max-width: 1200px;">
            <div class="chamber-header-modern">
                <div style="display: inline-block; padding: 0.5rem 1rem; background: linear-gradient(135deg, var(--accent-purple), var(--accent-blue)); border-radius: 20px; font-size: 0.85rem; font-weight: 600; margin-bottom: 1rem;">Enoch Calendar</div>
                <h2 class="chamber-title">Your Sacred Journey</h2>
                <p style="color: var(--text-secondary); font-size: 1.1rem;">364-Day Divine Calendar ‚Ä¢ Begins Spring Equinox</p>
            </div>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin: 2rem 0;">
                <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.5rem;">
                    <div style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 0.5rem;">Current Day</div>
                    <div style="font-size: 2rem; font-weight: 700; background: linear-gradient(135deg, #F59E0B, #8B5CF6); -webkit-background-clip: text; -webkit-text-fill-color: transparent;" id="stat-enoch-day">1/364</div>
                </div>
                <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.5rem;">
                    <div style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 0.5rem;">Days Logged</div>
                    <div style="font-size: 2rem; font-weight: 700; background: linear-gradient(135deg, #F59E0B, #8B5CF6); -webkit-background-clip: text; -webkit-text-fill-color: transparent;" id="stat-days">0</div>
                </div>
                <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 16px; padding: 1.5rem;">
                    <div style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 0.5rem;">Current Month</div>
                    <div style="font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #F59E0B, #8B5CF6); -webkit-background-clip: text; -webkit-text-fill-color: transparent;" id="stat-month-name">Loading...</div>
                </div>
            </div>

            <div style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(245, 158, 11, 0.1)); border: 1px solid var(--accent-purple); border-radius: 16px; padding: 1.5rem; margin-bottom: 2rem; text-align: center;">
                <div style="font-size: 1rem; font-weight: 600; color: var(--accent-gold); margin-bottom: 0.5rem;">üå∏ Enoch Calendar System</div>
                <div style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">
                    364-day sacred calendar ‚Ä¢ 12 Hebrew months ‚Ä¢ 4 seasons of 91 days ‚Ä¢ Always starts Spring Equinox (March 20) ‚Ä¢ Pure divine timing
                </div>
            </div>

            <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 20px; padding: 2rem;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <div style="font-size: 1.5rem; font-weight: 600; font-family: 'Playfair Display', serif;" id="calendar-month">Loading...</div>
                    <div style="display: flex; gap: 1rem;">
                        <button style="width: 40px; height: 40px; background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 10px; color: white; cursor: pointer;" onclick="prevMonth()">‚Äπ</button>
                        <button style="width: 40px; height: 40px; background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 10px; color: white; cursor: pointer;" onclick="nextMonth()">‚Ä∫</button>
                    </div>
                </div>
                <div style="text-align: center; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">üìÖ Today auto-tracked ‚Ä¢ Click any day to log spiritual practices</div>
                <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 0.5rem;" id="calendar-grid"></div>
            </div>
        </div>
    </div>

    <!-- Daily Log Modal -->
    <div style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(10px); display: none; align-items: center; justify-content: center; z-index: 3000;" id="daily-log-modal">
        <div style="max-width: 600px; width: 90%; max-height: 85vh; overflow-y: auto; background: var(--glass-bg); backdrop-filter: blur(30px); border: 1px solid var(--glass-border); border-radius: 24px; padding: 2.5rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <div>
                    <h3 style="font-family: 'Playfair Display', serif; font-size: 1.8rem; color: var(--accent-gold);" id="log-date-title">Day Log</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;" id="log-date-subtitle">Track your spiritual practices</p>
                </div>
                <button onclick="closeDailyLog()" style="background: none; border: none; color: var(--text-primary); font-size: 2rem; cursor: pointer;">‚úï</button>
            </div>

            <div id="practice-list" style="display: grid; gap: 1rem; margin: 1.5rem 0;"></div>

            <div style="margin-top: 2rem;">
                <label style="display: block; font-weight: 500; margin-bottom: 0.75rem;">Daily Reflection</label>
                <textarea id="daily-reflection" class="reflection-textarea" placeholder="What insights did you receive today?" style="min-height: 100px;"></textarea>
            </div>

            <button class="btn-modern" onclick="saveDailyLog()" style="width: 100%; margin-top: 2rem;">üíæ Save Daily Log</button>
        </div>
    </div>

   <script>
        // ============================================
        // STATE MANAGEMENT WITH HEBREW CALENDAR
        // ============================================
        let state = {
            // ENOCH CALENDAR STATE WITH HEBREW MONTHS
            enochCalendar: {
                months: [
                    { name: 'Aviv', hebrew: '◊ê÷∏◊ë÷¥◊ô◊ë', days: 30, season: 'Spring', theme: 'Renewal', color: '#8B5CF6' },
                    { name: 'Ziv', hebrew: '◊ñ÷¥◊ï', days: 30, season: 'Spring', theme: 'Radiance', color: '#8B5CF6' },
                    { name: 'Sivan', hebrew: '◊°÷¥◊ô◊ï÷∏◊ü', days: 31, season: 'Spring', theme: 'Harvest', color: '#8B5CF6' },
                    { name: 'Tammuz', hebrew: '◊™÷∑÷º◊û÷º◊ï÷º◊ñ', days: 30, season: 'Summer', theme: 'Heat', color: '#F59E0B' },
                    { name: 'Av', hebrew: '◊ê÷∏◊ë', days: 30, season: 'Summer', theme: 'Strength', color: '#F59E0B' },
                    { name: 'Elul', hebrew: '◊ê÷±◊ú◊ï÷º◊ú', days: 31, season: 'Summer', theme: 'Completion', color: '#F59E0B' },
                    { name: 'Ethanim', hebrew: '◊ê÷µ◊ô◊™÷∏◊†÷¥◊ô◊ù', days: 30, season: 'Autumn', theme: 'Foundation', color: '#3B82F6' },
                    { name: 'Bul', hebrew: '◊ë÷º◊ï÷º◊ú', days: 30, season: 'Autumn', theme: 'Preparation', color: '#3B82F6' },
                    { name: 'Kislev', hebrew: '◊õ÷¥÷º◊°÷∞◊ú÷µ◊ï', days: 31, season: 'Autumn', theme: 'Security', color: '#3B82F6' },
                    { name: 'Tevet', hebrew: '◊ò÷µ◊ë÷µ◊™', days: 30, season: 'Winter', theme: 'Reflection', color: '#10B981' },
                    { name: 'Shevat', hebrew: '◊©÷∞◊Å◊ë÷∏◊ò', days: 30, season: 'Winter', theme: 'Endurance', color: '#10B981' },
                    { name: 'Adar', hebrew: '◊ê÷≤◊ì÷∏◊®', days: 31, season: 'Winter', theme: 'Victory', color: '#10B981' }
                ],
                currentMonthIndex: 0,
                currentDayOfMonth: 1,
                currentEnochDay: 1,
                todayEnochDay: 1,
                todayMonthIndex: 0,
                todayDayOfMonth: 1
            },
            
            dailyLogs: {},
            currentLogDate: null
        };

        // ============================================
        // ENOCH CALENDAR AUTO-DATE CONVERTER
        // ============================================
        function calculateEnochDate() {
            const today = new Date();
            const currentYear = today.getFullYear();
            
            // Spring Equinox - Enoch Year Start (March 20)
            // Enoch calendar always starts March 20 (Spring Equinox)
            const springEquinox = new Date(currentYear, 2, 20); // Month 2 = March (0-indexed)
            
            // If we haven't reached this year's equinox yet, use last year's
            const enochYearStart = today < springEquinox 
                ? new Date(currentYear - 1, 2, 20) 
                : springEquinox;
            
            // Calculate days since Enoch year started
            const millisecondsPerDay = 1000 * 60 * 60 * 24;
            const daysSinceStart = Math.floor((today - enochYearStart) / millisecondsPerDay);
            
            // Enoch day of year (1-364, then resets)
            const enochDay = (daysSinceStart % 364) + 1;
            
            // Find which month we're in
            const months = state.enochCalendar.months;
            let daysAccumulated = 0;
            let currentMonthIndex = 0;
            let dayOfMonth = 0;
            
            for (let i = 0; i < months.length; i++) {
                if (enochDay <= daysAccumulated + months[i].days) {
                    currentMonthIndex = i;
                    dayOfMonth = enochDay - daysAccumulated;
                    break;
                }
                daysAccumulated += months[i].days;
            }
            
            // Update state with today's date
            state.enochCalendar.todayEnochDay = enochDay;
            state.enochCalendar.todayMonthIndex = currentMonthIndex;
            state.enochCalendar.todayDayOfMonth = dayOfMonth;
            
            // Set current view to today
            state.enochCalendar.currentMonthIndex = currentMonthIndex;
            state.enochCalendar.currentDayOfMonth = dayOfMonth;
            state.enochCalendar.currentEnochDay = enochDay;
            
            // Update header display
            const month = months[currentMonthIndex];
            document.getElementById('header-enoch-date').textContent = 
                `${month.name} ${dayOfMonth}`;
            
            document.getElementById('portal-subtitle').textContent = 
                `Today: ${month.name} ${dayOfMonth} (${month.hebrew}) - Day ${enochDay}/364`;
            
            console.log('üìÖ Enoch Calendar Initialized:');
            console.log('Today is:', month.name, dayOfMonth);
            console.log('Hebrew:', month.hebrew);
            console.log('Day', enochDay, 'of 364');
            console.log('Season:', month.season);
            console.log('Theme:', month.theme);
            console.log('Enoch Year Started:', enochYearStart.toLocaleDateString());
            
            return {
                enochDay: enochDay,
                monthIndex: currentMonthIndex,
                monthName: month.name,
                monthHebrew: month.hebrew,
                dayOfMonth: dayOfMonth,
                season: month.season,
                theme: month.theme,
                color: month.color,
                quarter: Math.floor(currentMonthIndex / 3) + 1,
                gregorianDate: today,
                enochYearStart: enochYearStart
            };
        }

        // ============================================
        // CALENDAR DISPLAY FUNCTIONS
        // ============================================
        function updateCalendar() {
            const months = state.enochCalendar.months;
            const currentMonth = months[state.enochCalendar.currentMonthIndex];
            const isToday = state.enochCalendar.currentMonthIndex === state.enochCalendar.todayMonthIndex;
            
            // Quarter colors
            const quarter = Math.floor(state.enochCalendar.currentMonthIndex / 3);
            const quarterColor = currentMonth.color;
            
            // Update month header with Hebrew
            document.getElementById('calendar-month').innerHTML = `
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <div style="font-size: 2rem; font-family: 'Playfair Display', serif; transition: color 0.3s;" 
                             onmouseover="this.style.color='${quarterColor}'" 
                             onmouseout="this.style.color='white'">${currentMonth.name}</div>
                        <div style="font-size: 1.5rem; opacity: 0.6; font-weight: 300;">${currentMonth.hebrew}</div>
                    </div>
                    <div style="display: flex; gap: 1.5rem; font-size: 0.85rem; color: var(--text-secondary); flex-wrap: wrap;">
                        <div><span style="color: ${quarterColor};">‚óè</span> ${currentMonth.season}</div>
                        <div>Quarter ${quarter + 1}/4</div>
                        <div>${currentMonth.theme}</div>
                        <div>${currentMonth.days} days</div>
                    </div>
                </div>
            `;
            
            // Update stats
            let daysBeforeMonth = 0;
            for (let i = 0; i < state.enochCalendar.currentMonthIndex; i++) {
                daysBeforeMonth += months[i].days;
            }
            const startDayOfMonth = daysBeforeMonth + 1;
            const endDayOfMonth = daysBeforeMonth + currentMonth.days;
            
            document.getElementById('stat-enoch-day').textContent = 
                `${startDayOfMonth}-${endDayOfMonth}/364`;
            
            document.getElementById('stat-month-name').textContent = 
                `${currentMonth.name}`;
            
            // Build calendar grid
            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';
            
            // Day headers (Enoch week starts Wednesday)
            const days = ['Wed', 'Thu', 'Fri', 'Sat', 'Sun', 'Mon', 'Tue'];
            for (let d = 0; d < days.length; d++) {
                const cell = document.createElement('div');
                cell.style.cssText = `
                    background: transparent; 
                    color: var(--text-secondary); 
                    font-weight: 600; 
                    font-size: 0.75rem; 
                    text-transform: uppercase; 
                    display: flex; 
                    align-items: center; 
                    justify-content: center; 
                    padding: 0.75rem;
                    border-bottom: 2px solid ${quarterColor}33;
                `;
                cell.textContent = days[d];
                grid.appendChild(cell);
            }
            
            // Create day cells
            for (let day = 1; day <= currentMonth.days; day++) {
                const cell = document.createElement('div');
                const enochDayNum = daysBeforeMonth + day;
                const dateKey = `enoch-${state.enochCalendar.currentMonthIndex}-${day}`;
                const hasLog = state.dailyLogs[dateKey];
                const isTodayCell = isToday && day === state.enochCalendar.todayDayOfMonth;
                
                cell.style.cssText = `
                    aspect-ratio: 1; 
                    display: flex; 
                    flex-direction: column; 
                    align-items: center; 
                    justify-content: center; 
                    gap: 0.25rem; 
                    background: ${isTodayCell ? `linear-gradient(135deg, ${quarterColor}44, ${quarterColor}22)` : hasLog ? 'rgba(16, 185, 129, 0.15)' : 'rgba(255, 255, 255, 0.03)'}; 
                    border-radius: 12px; 
                    cursor: pointer; 
                    transition: all 0.3s; 
                    border: ${isTodayCell ? `3px solid ${quarterColor}` : `1px solid ${quarterColor}22`};
                    position: relative;
                    overflow: hidden;
                `;
                
                // Add shimmer effect to today
                if (isTodayCell) {
                    cell.innerHTML = `
                        <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; 
                             background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); 
                             animation: shimmer 2s infinite;"></div>
                    `;
                }
                
                cell.innerHTML += `
                    <div style="font-size: 1.1rem; font-weight: ${isTodayCell ? '700' : '500'}; 
                         color: ${isTodayCell ? quarterColor : 'white'};">${day}</div>
                    <div style="font-size: 0.65rem; opacity: 0.6;">Day ${enochDayNum}</div>
                `;
                
                // Add practice indicators
                if (hasLog && hasLog.practices) {
                    const icons = { 
                        meditation: 'üßò', 
                        prayer: 'üôè', 
                        scripture: 'üìñ', 
                        gratitude: '‚ú®',
                        fasting: 'üïØÔ∏è',
                        worship: 'üéµ'
                    };
                    let practiceIcons = '';
                    for (let key in hasLog.practices) {
                        if (hasLog.practices[key] && icons[key]) practiceIcons += icons[key];
                    }
                    if (practiceIcons) {
                        cell.innerHTML += `<div style="font-size: 0.7rem; margin-top: 0.25rem;">${practiceIcons.substring(0, 12)}</div>`;
                    }
                }
                
                // Add "Today" badge
                if (isTodayCell) {
                    cell.innerHTML += `<div style="position: absolute; top: 0.25rem; right: 0.25rem; 
                         background: ${quarterColor}; color: white; font-size: 0.6rem; 
                         padding: 0.15rem 0.4rem; border-radius: 8px; font-weight: 700;">TODAY</div>`;
                }
                
                // Hover effect
                cell.onmouseover = function() {
                    if (!isTodayCell) {
                        this.style.transform = 'scale(1.05)';
                        this.style.borderColor = quarterColor;
                    }
                };
                cell.onmouseout = function() {
                    if (!isTodayCell) {
                        this.style.transform = 'scale(1)';
                        this.style.borderColor = quarterColor + '22';
                    }
                };
                
                cell.onclick = function() { 
                    openDailyLog(dateKey, currentMonth.name, currentMonth.hebrew, day, enochDayNum, currentMonth.theme, currentMonth.season, quarterColor); 
                };
                
                grid.appendChild(cell);
            }
        }

        function prevMonth() {
            state.enochCalendar.currentMonthIndex = 
                state.enochCalendar.currentMonthIndex === 0 
                ? 11 
                : state.enochCalendar.currentMonthIndex - 1;
            updateCalendar();
        }

        function nextMonth() {
            state.enochCalendar.currentMonthIndex = 
                state.enochCalendar.currentMonthIndex === 11 
                ? 0 
                : state.enochCalendar.currentMonthIndex + 1;
            updateCalendar();
        }

        // ============================================
        // DAILY LOG FUNCTIONS
        // ============================================
        

    
    // PART 1: Practice Checkboxes with Duration
    const practices = [
        { id: 'meditation', icon: 'üßò', label: 'Meditation', desc: 'Centered and present', hasDuration: true },
        { id: 'prayer', icon: 'üôè', label: 'Prayer', desc: 'Communed with divine', hasDuration: true },
        { id: 'scripture', icon: 'üìñ', label: 'Scripture Study', desc: 'Studied sacred texts', hasDuration: true },
        { id: 'gratitude', icon: '‚ú®', label: 'Gratitude Practice', desc: 'Counted blessings', hasDuration: false },
        { id: 'fasting', icon: 'üïØÔ∏è', label: 'Fasting', desc: 'Spiritual discipline', hasDuration: false },
        { id: 'worship', icon: 'üéµ', label: 'Worship', desc: 'Praised in song/spirit', hasDuration: true }
    ];
    
    let html = '<h4 style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--accent-gold);">üìù Daily Practices</h4>';
    
    for (let p of practices) {
        const checked = existingLog.practices[p.id];
        const duration = existingLog.duration[p.id] || '';
        
        html += `
            <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; 
                 background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); 
                 border-radius: 12px; transition: all 0.3s; margin-bottom: 0.75rem;" 
                 id="practice-${p.id}"
                 onmouseover="this.style.borderColor='${color}'; this.style.background='rgba(255,255,255,0.05)'"
                 onmouseout="this.style.borderColor='var(--glass-border)'; this.style.background='rgba(255,255,255,0.03)'">
                <div style="width: 24px; height: 24px; border: 2px solid var(--glass-border); 
                     border-radius: 6px; display: flex; align-items: center; justify-content: center; 
                     cursor: pointer; transition: all 0.3s; ${checked ? `background: linear-gradient(135deg, ${color}, ${color}dd); border-color: transparent;` : ''}" 
                     id="check-${p.id}"
                     onclick="togglePractice('${p.id}')">
                    ${checked ? '‚úì' : ''}
                </div>
                <div style="font-size: 1.5rem;">${p.icon}</div>
                <div style="flex: 1;">
                    <div style="font-weight: 500;">${p.label}</div>
                    <div style="font-size: 0.8rem; color: var(--text-secondary);">${p.desc}</div>
                </div>
                ${p.hasDuration ? `
                    <input type="number" 
                           id="duration-${p.id}" 
                           value="${duration}" 
                           placeholder="mins"
                           min="0"
                           style="width: 60px; padding: 0.5rem; background: rgba(255,255,255,0.05); 
                                  border: 1px solid var(--glass-border); border-radius: 8px; 
                                  color: white; text-align: center;"
                           onchange="saveDuration('${p.id}', this.value)">
                ` : ''}
            </div>
        `;
    }
    
    // PART 2: Energy & Mood
    html += `
        <h4 style="font-size: 1.2rem; margin: 2rem 0 1rem; color: var(--accent-gold);">üí´ Energy & Mood</h4>
        <div style="background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); 
             border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Energy Level (1-10)</label>
            <input type="range" id="energy-level" min="1" max="10" value="${existingLog.energyLevel || 5}" 
                   style="width: 100%; margin-bottom: 0.5rem;"
                   oninput="document.getElementById('energy-value').textContent = this.value">
            <div style="text-align: center; font-size: 1.5rem; font-weight: 700; color: ${color};" id="energy-value">${existingLog.energyLevel || 5}</div>
        </div>
        
        <div style="background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); 
             border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
            <label style="display: block; margin-bottom: 0.75rem; font-weight: 500;">Today's Mood</label>
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem;">
                ${['Peaceful', 'Joyful', 'Contemplative', 'Struggling'].map(mood => `
                    <div onclick="selectMood('${mood}')" 
                         id="mood-${mood}"
                         style="padding: 0.75rem; text-align: center; background: ${existingLog.mood === mood ? color + '44' : 'rgba(255,255,255,0.03)'}; 
                                border: 1px solid ${existingLog.mood === mood ? color : 'var(--glass-border)'}; 
                                border-radius: 8px; cursor: pointer; font-size: 0.85rem; transition: all 0.3s;"
                         onmouseover="if(this.id !== 'mood-${existingLog.mood}') this.style.borderColor='${color}'"
                         onmouseout="if(this.id !== 'mood-${existingLog.mood}') this.style.borderColor='var(--glass-border)'">
                        ${mood}
                    </div>
                `).join('')}
            </div>
        </div>
    `;
    
    // PART 3: Gratitude List
    html += `
        <h4 style="font-size: 1.2rem; margin: 2rem 0 1rem; color: var(--accent-gold);">‚ú® Gratitude (3 Things)</h4>
        <div style="background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); 
             border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
            <input type="text" id="gratitude-1" value="${existingLog.gratitudeList[0] || ''}" 
                   placeholder="1. I am grateful for..." 
                   style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); 
                          border: 1px solid var(--glass-border); border-radius: 8px; 
                          color: white; margin-bottom: 0.75rem;">
            <input type="text" id="gratitude-2" value="${existingLog.gratitudeList[1] || ''}" 
                   placeholder="2. I am grateful for..." 
                   style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); 
                          border: 1px solid var(--glass-border); border-radius: 8px; 
                          color: white; margin-bottom: 0.75rem;">
            <input type="text" id="gratitude-3" value="${existingLog.gratitudeList[2] || ''}" 
                   placeholder="3. I am grateful for..." 
                   style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); 
                          border: 1px solid var(--glass-border); border-radius: 8px; 
                          color: white;">
        </div>
    `;
    
    // PART 4: Scripture Passages
    html += `
        <h4 style="font-size: 1.2rem; margin: 2rem 0 1rem; color: var(--accent-gold);">üìñ Scripture That Spoke Today</h4>
        <div style="background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); 
             border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
            <input type="text" id="scripture-passages" value="${existingLog.scripturePassages.join(', ')}" 
                   placeholder="e.g., Psalm 23:1, John 3:16, Proverbs 3:5-6" 
                   style="width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.05); 
                          border: 1px solid var(--glass-border); border-radius: 8px; 
                          color: white;">
            <div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                Separate multiple passages with commas
            </div>
        </div>
    `;
    
    // PART 5: Challenges & Blessings
    html += `
        <h4 style="font-size: 1.2rem; margin: 2rem 0 1rem; color: var(--accent-gold);">‚ö° Challenges Faced</h4>
        <textarea id="challenges-faced" 
                  placeholder="What challenges or struggles did you face today?" 
                  style="width: 100%; padding: 1rem; background: rgba(255,255,255,0.05); 
                         border: 1px solid var(--glass-border); border-radius: 12px; 
                         color: white; min-height: 80px; resize: vertical; font-family: 'Inter', sans-serif; margin-bottom: 1rem;">${existingLog.challengesFaced || ''}</textarea>
        
        <h4 style="font-size: 1.2rem; margin: 2rem 0 1rem; color: var(--accent-gold);">üåü Blessings Received</h4>
        <textarea id="blessings-received" 
                  placeholder="What blessings, synchronicities, or answered prayers did you receive?" 
                  style="width: 100%; padding: 1rem; background: rgba(255,255,255,0.05); 
                         border: 1px solid var(--glass-border); border-radius: 12px; 
                         color: white; min-height: 80px; resize: vertical; font-family: 'Inter', sans-serif; margin-bottom: 1rem;">${existingLog.blessingsReceived || ''}</textarea>
        
        <h4 style="font-size: 1.2rem; margin: 2rem 0 1rem; color: var(--accent-gold);">üíé Divine Guidance</h4>
        <textarea id="divine-guidance" 
                  placeholder="What messages, insights, or guidance did you receive today?" 
                  style="width: 100%; padding: 1rem; background: rgba(255,255,255,0.05); 
                         border: 1px solid var(--glass-border); border-radius: 12px; 
                         color: white; min-height: 80px; resize: vertical; font-family: 'Inter', sans-serif; margin-bottom: 1rem;">${existingLog.divineGuidance || ''}</textarea>
    `;
    
    document.getElementById('practice-list').innerHTML = html;
    document.getElementById('daily-reflection').value = existingLog.reflection || '';
    document.getElementById('daily-log-modal').style.display = 'flex';
}
            
            document.getElementById('practice-list').innerHTML = html;
            document.getElementById('daily-reflection').value = existingLog.reflection || '';
            document.getElementById('daily-log-modal').style.display = 'flex';
        }
    
    const log = state.dailyLogs[state.currentLogDate];
    
    // Save all the data
    log.reflection = document.getElementById('daily-reflection').value;
    log.energyLevel = parseInt(document.getElementById('energy-level').value);
    
    log.gratitudeList = [
        document.getElementById('gratitude-1').value,
        document.getElementById('gratitude-2').value,
        document.getElementById('gratitude-3').value
    ].filter(g => g.trim() !== '');
    
    const scriptureInput = document.getElementById('scripture-passages').value;
    log.scripturePassages = scriptureInput ? scriptureInput.split(',').map(s => s.trim()) : [];
    
    log.challengesFaced = document.getElementById('challenges-faced').value;
    log.blessingsReceived = document.getElementById('blessings-received').value;
    log.divineGuidance = document.getElementById('divine-guidance').value;
    
    // Save to localStorage
    localStorage.setItem('edenDailyLogs', JSON.stringify(state.dailyLogs));
    
    updateCalendar();
    const daysLogged = Object.keys(state.dailyLogs).length;
    document.getElementById('stat-days').textContent = daysLogged;
    closeDailyLog();
    
    alert('‚ú® Daily log saved! Your spiritual journey is documented.');
    console.log('üìñ Log saved for', state.currentLogDate);
}
            
       function saveDuration(practice, value) {
    if (!state.currentLogDate) return;
    if (!state.dailyLogs[state.currentLogDate]) {
        state.dailyLogs[state.currentLogDate] = { practices: {}, duration: {} };
    }
    state.dailyLogs[state.currentLogDate].duration[practice] = value;
}

function selectMood(mood) {
    if (!state.currentLogDate) return;
    if (!state.dailyLogs[state.currentLogDate]) {
        state.dailyLogs[state.currentLogDate] = {};
    }
    state.dailyLogs[state.currentLogDate].mood = mood;
    
    // Update UI
    ['Peaceful', 'Joyful', 'Contemplative', 'Struggling'].forEach(m => {
        const el = document.getElementById('mood-' + m);
        const month = state.enochCalendar.months[state.enochCalendar.currentMonthIndex];
        if (m === mood) {
            el.style.background = month.color + '44';
            el.style.borderColor = month.color;
        } else {
            el.style.background = 'rgba(255,255,255,0.03)';
            el.style.borderColor = 'var(--glass-border)';
        }
    });
}
            state.dailyLogs[state.currentLogDate].reflection = 
                document.getElementById('daily-reflection').value;
            
            // Save to localStorage
            localStorage.setItem('edenDailyLogs', JSON.stringify(state.dailyLogs));
            
            updateCalendar();
            const daysLogged = Object.keys(state.dailyLogs).length;
            document.getElementById('stat-days').textContent = daysLogged;
            closeDailyLog();
            
            alert('‚ú® Daily log saved! Keep building your practice!');
        }

        function closeDailyLog() {
            document.getElementById('daily-log-modal').style.display = 'none';
            state.currentLogDate = null;
        }

        // ============================================
        // CALENDAR PANEL FUNCTIONS
        // ============================================
        function openCalendar() {
            document.getElementById('portal-container').style.display = 'none';
            document.getElementById('calendar-panel').classList.add('open');
            updateCalendar();
        }

        function closePanel(panelId) {
            document.getElementById(panelId).classList.remove('open');
            document.getElementById('portal-container').style.display = 'block';
        }

// ============================================
        // THREE.JS TEMPLE ANIMATION
        // ============================================
        let scene, camera, renderer;
        function initThreeJS() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 30;
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x000000, 0);
            document.getElementById('temple-3d').appendChild(renderer.domElement);

            const geometry = new THREE.BufferGeometry();
            const vertices = [];
            for (let i = 0; i < 500; i++) {
                vertices.push(
                    Math.random() * 100 - 50, 
                    Math.random() * 100 - 50, 
                    Math.random() * 100 - 50
                );
            }
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
            const material = new THREE.PointsMaterial({ 
                color: 0x8B5CF6, 
                size: 0.5, 
                transparent: true, 
                opacity: 0.6 
            });
            const particles = new THREE.Points(geometry, material);
            scene.add(particles);

            function animate() {
                requestAnimationFrame(animate);
                scene.rotation.y += 0.0005;
                renderer.render(scene, camera);
            }
            animate();
            
            window.addEventListener('resize', function() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }

        // ============================================
        // AUDIO SYSTEM (Sacred Frequencies)
        // ============================================
        let audioContext = null;
        let backgroundMusic = null;
        let isMusicPlaying = false;

        function initAudio() {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        }

        function toggleBackgroundMusic() {
            if (!audioContext) initAudio();
            
            if (isMusicPlaying) {
                stopBackgroundMusic();
            } else {
                startBackgroundMusic();
            }
        }

        function startBackgroundMusic() {
            if (!audioContext) initAudio();
            
            // Create oscillators for ambient sound
            const osc1 = audioContext.createOscillator();
            const osc2 = audioContext.createOscillator();
            const osc3 = audioContext.createOscillator();
            
            const gain1 = audioContext.createGain();
            const gain2 = audioContext.createGain();
            const gain3 = audioContext.createGain();
            const masterGain = audioContext.createGain();
            
            osc1.connect(gain1);
            osc2.connect(gain2);
            osc3.connect(gain3);
            
            gain1.connect(masterGain);
            gain2.connect(masterGain);
            gain3.connect(masterGain);
            masterGain.connect(audioContext.destination);
            
            // Sacred frequencies
            osc1.frequency.value = 432; // Universal harmony
            osc2.frequency.value = 528; // Love frequency  
            osc3.frequency.value = 639; // Connection frequency
            
            osc1.type = 'sine';
            osc2.type = 'sine';
            osc3.type = 'triangle';
            
            gain1.gain.value = 0.03;
            gain2.gain.value = 0.02;
            gain3.gain.value = 0.015;
            masterGain.gain.value = 0.3;
            
            osc1.start();
            osc2.start();
            osc3.start();
            
            backgroundMusic = { osc1, osc2, osc3, masterGain };
            isMusicPlaying = true;
            
            document.getElementById('music-btn').textContent = 'üîá Mute';
            document.getElementById('music-btn').style.background = 'linear-gradient(135deg, var(--accent-gold), #F97316)';
            
            console.log('üéµ Sacred frequencies activated: 432Hz, 528Hz, 639Hz');
        }

        function stopBackgroundMusic() {
            if (backgroundMusic) {
                backgroundMusic.osc1.stop();
                backgroundMusic.osc2.stop();
                backgroundMusic.osc3.stop();
                backgroundMusic = null;
                isMusicPlaying = false;
                
                document.getElementById('music-btn').textContent = 'üéµ Music';
                document.getElementById('music-btn').style.background = 'linear-gradient(135deg, var(--accent-purple), var(--accent-blue))';
            }
        }

        // ============================================
        // LOCAL STORAGE MANAGEMENT
        // ============================================
        function loadFromStorage() {
            try {
                const savedLogs = localStorage.getItem('edenDailyLogs');
                if (savedLogs) {
                    state.dailyLogs = JSON.parse(savedLogs);
                    const daysLogged = Object.keys(state.dailyLogs).length;
                    document.getElementById('stat-days').textContent = daysLogged;
                    console.log('üìñ Loaded', daysLogged, 'saved daily logs');
                }
            } catch (e) {
                console.error('Error loading from storage:', e);
            }
        }

        // ============================================
        // INITIALIZATION
        // ============================================
        function initialize() {
            console.log('üèõÔ∏è Initializing Eden Consciousness Temple...');
            
            // Initialize 3D temple
            initThreeJS();
            
            // Initialize audio
            initAudio();
            
            // Calculate and display Enoch date
            const today = calculateEnochDate();
            console.log('‚úÖ Today calculated:', today);
            
            // Load saved data
            loadFromStorage();
            
            // Welcome message
            console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');
            console.log('üèõÔ∏è EDEN CONSCIOUSNESS TEMPLE');
            console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');
            console.log('üìÖ Enoch Calendar: ACTIVE');
            console.log('üóìÔ∏è  Today:', today.monthName, today.dayOfMonth, `(${today.monthHebrew})`);
            console.log('üìä Day:', today.enochDay, 'of 364');
            console.log('üå∏ Season:', today.season);
            console.log('üíé Theme:', today.theme);
            console.log('üéØ Quarter:', today.quarter, 'of 4');
            console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');
            console.log('‚ú® Temple initialized successfully!');
            console.log('üìñ Click Sacred Calendar to begin your journey');
            console.log('‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ');
        }

        // Run initialization when page loads
        window.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
