class DivineTempleAPITester{constructor(){this.results={firebase:null,authentication:null,ai_chatbot:null,integrations:null,payments:null,overall:null},this.startTime=Date.now()}async runAllTests(){console.log("ðŸ§ª Starting Divine Temple API Integration Tests..."),console.log("=".repeat(50));try{await this.testFirebaseConfig(),await this.testAuthentication(),await this.testAIChatbot(),await this.testIntegrations(),await this.testPaymentSystem(),this.generateReport()}catch(e){console.error("âŒ Test suite failed:",e)}}async testFirebaseConfig(){console.log("\nðŸ”¥ Testing Firebase Configuration...");try{if("undefined"==typeof firebase)throw new Error("Firebase SDK not loaded");if(!firebase.apps.length)throw new Error("Firebase app not initialized");const e=firebase.firestore();await e.collection("test").doc("api-test").set({timestamp:firebase.firestore.FieldValue.serverTimestamp(),test:"API integration test"});if(!firebase.auth())throw new Error("Firebase Auth not initialized");this.results.firebase={status:"PASS",message:"Firebase fully configured and operational",details:{sdk_loaded:!0,app_initialized:!0,firestore_connected:!0,auth_initialized:!0}},console.log("âœ… Firebase: PASS")}catch(e){this.results.firebase={status:"FAIL",message:e.message,details:{error:e.toString()}},console.log("âŒ Firebase: FAIL -",e.message)}}async testAuthentication(){console.log("\nðŸ” Testing Authentication Systems...");try{const e={admin_credentials:!1,firebase_auth:!1,session_management:!1};window.divineTemple&&"function"==typeof window.divineTemple.forceAdminLogin&&(e.admin_credentials=!0),firebase.auth()&&(e.firebase_auth=!0);null!==sessionStorage.getItem("divineAuth")&&(e.session_management=!0);const t=Object.values(e).every(e=>e);this.results.authentication={status:t?"PASS":"PARTIAL",message:t?"All authentication systems working":"Some authentication issues detected",details:e},console.log(t?"âœ… Authentication: PASS":"âš ï¸ Authentication: PARTIAL")}catch(e){this.results.authentication={status:"FAIL",message:e.message,details:{error:e.toString()}},console.log("âŒ Authentication: FAIL -",e.message)}}async testAIChatbot(){console.log("\nðŸ¤– Testing AI Chatbot Backend...");try{const e={functions_available:!1,security_configured:!1,fallback_responses:!1};if(firebase.functions){e.functions_available=!0;try{firebase.functions().httpsCallable("chatWithAI");e.security_configured=!0}catch(e){console.warn("Firebase Functions not configured yet")}}if(window.AIChatbot&&"function"==typeof window.AIChatbot){"function"==typeof(new AIChatbot).getFallbackResponse&&(e.fallback_responses=!0)}const t=e.functions_available&&e.fallback_responses;this.results.ai_chatbot={status:t?"READY":"NEEDS_SETUP",message:t?"AI chatbot ready (needs OpenAI key)":"AI chatbot needs configuration",details:e},console.log(t?"ðŸŸ¡ AI Chatbot: READY (needs OpenAI deployment)":"âŒ AI Chatbot: NEEDS SETUP")}catch(e){this.results.ai_chatbot={status:"FAIL",message:e.message,details:{error:e.toString()}},console.log("âŒ AI Chatbot: FAIL -",e.message)}}async testIntegrations(){console.log("\nðŸ”— Testing OAuth Integrations...");try{const e={config_loaded:!1,callback_handler:!1,spotify_config:!1,google_config:!1};window.INTEGRATION_CONFIG&&(e.config_loaded=!0,window.INTEGRATION_CONFIG.spotify&&"YOUR_SPOTIFY_CLIENT_ID"!==window.INTEGRATION_CONFIG.spotify.clientId&&(e.spotify_config=!0),window.INTEGRATION_CONFIG.google&&"YOUR_GOOGLE_CLIENT_ID"!==window.INTEGRATION_CONFIG.google.clientId&&(e.google_config=!0));try{(await fetch("./callback.html",{method:"HEAD"})).ok&&(e.callback_handler=!0)}catch(e){console.warn("Callback handler check failed")}const t=e.config_loaded&&e.callback_handler;this.results.integrations={status:t?"CONFIGURED":"NEEDS_SETUP",message:t?"Integration system configured":"Integrations need OAuth setup",details:e},console.log(t?"ðŸŸ¡ Integrations: CONFIGURED (needs OAuth keys)":"âŒ Integrations: NEEDS SETUP")}catch(e){this.results.integrations={status:"FAIL",message:e.message,details:{error:e.toString()}},console.log("âŒ Integrations: FAIL -",e.message)}}async testPaymentSystem(){console.log("\nðŸ’³ Testing Payment System...");try{const e={stripe_js_loaded:!1,purchase_system:!1,config_present:!1};"undefined"!=typeof Stripe&&(e.stripe_js_loaded=!0),window.InAppPurchases&&"function"==typeof window.InAppPurchases&&(e.purchase_system=!0);(localStorage.getItem("stripe_publishable_key")||sessionStorage.getItem("stripe_publishable_key"))&&(e.config_present=!0);const t=e.purchase_system;this.results.payments={status:t?"READY":"NEEDS_SETUP",message:t?"Payment system ready (needs Stripe keys)":"Payment system needs configuration",details:e},console.log(t?"ðŸŸ¡ Payments: READY (needs Stripe setup)":"âŒ Payments: NEEDS SETUP")}catch(e){this.results.payments={status:"FAIL",message:e.message,details:{error:e.toString()}},console.log("âŒ Payments: FAIL -",e.message)}}generateReport(){console.log("\nðŸ“Š DIVINE TEMPLE API INTEGRATION TEST REPORT"),console.log("=".repeat(50));const e=((Date.now()-this.startTime)/1e3).toFixed(2);console.log(`ðŸ• Test Duration: ${e} seconds`),console.log(`ðŸ“… Test Date: ${(new Date).toISOString()}`),console.log("");let t=0,s=0;Object.entries(this.results).forEach(([e,o])=>{if(o&&"overall"!==e){s++;const n=o.status,i="PASS"===n?"âœ…":"READY"===n||"CONFIGURED"===n?"ðŸŸ¡":"PARTIAL"===n?"âš ï¸":"âŒ";console.log(`${i} ${e.toUpperCase()}: ${n} - ${o.message}`),"PASS"!==n&&"READY"!==n&&"CONFIGURED"!==n||t++}});const o=Math.round(t/s*100);let n,i;return o>=80?(n="ðŸŽ‰ EXCELLENT - Ready for production!",i=["1. Deploy Firebase Functions with OpenAI key","2. Set up Stripe products and keys","3. Configure OAuth applications","4. Run final end-to-end tests"]):o>=60?(n="ðŸŸ¡ GOOD - Some configuration needed",i=["1. Complete Firebase Functions setup","2. Configure missing API integrations","3. Test authentication flows","4. Set up payment processing"]):(n="âŒ NEEDS WORK - Major configuration required",i=["1. Fix Firebase configuration issues","2. Set up all missing API keys","3. Deploy backend functions","4. Test each system individually"]),console.log(""),console.log(`ðŸ“ˆ Overall Success Rate: ${o}% (${t}/${s})`),console.log(`ðŸŽ¯ Status: ${n}`),console.log(""),console.log("ðŸ“‹ NEXT STEPS:"),i.forEach(e=>console.log(`   ${e}`)),console.log(""),console.log("ðŸ’¡ FOR DETAILED SETUP INSTRUCTIONS:"),console.log("   1. Open QUICK_SETUP_GUIDE.md"),console.log("   2. Open api-setup.html in browser"),console.log("   3. Refer to DEPLOYMENT_GUIDE.md"),this.results.overall={success_rate:o,status:n,next_steps:i,test_duration:e},this.results}async quickFirebaseTest(){return await this.testFirebaseConfig(),this.results.firebase}async quickAuthTest(){return await this.testAuthentication(),this.results.authentication}async quickAITest(){return await this.testAIChatbot(),this.results.ai_chatbot}}window.DivineTempleAPITester=DivineTempleAPITester,window.location.search.includes("test=true")&&document.addEventListener("DOMContentLoaded",async()=>{const e=new DivineTempleAPITester;await e.runAllTests()}),console.log("ðŸ§ª Divine Temple API Tester loaded!"),console.log("ðŸ“– Usage:"),console.log("   const tester = new DivineTempleAPITester();"),console.log("   await tester.runAllTests();"),console.log(""),console.log("ðŸš€ Quick test: Add ?test=true to URL to auto-run tests");