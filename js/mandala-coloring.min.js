class MandalaColoringCanvas{constructor(){this.canvas=null,this.ctx=null,this.svg=null,this.currentMandala=null,this.currentColor="#ff6b6b",this.currentPalette="chakra",this.isDrawing=!1,this.brushSize=8,this.meditationTimer=0,this.timerInterval=null,this.isTimerRunning=!1,this.audioEnabled=!0,this.audioContext=null,this.ambientSound=null,this.drawingHistory=[],this.historyStep=-1,this.mandalaPatterns={lotus:{name:"Sacred Lotus",description:"Symbol of purity and enlightenment",paths:this.generateLotusPattern(),difficulty:"beginner",meaning:"The lotus represents spiritual awakening and the journey from darkness to light."},flower_of_life:{name:"Flower of Life",description:"Ancient symbol of creation",paths:this.generateFlowerOfLifePattern(),difficulty:"intermediate",meaning:"Sacred geometry pattern representing the fundamental forms of space and time."},sri_yantra:{name:"Sri Yantra",description:"Divine cosmic energy pattern",paths:this.generateSriYantraPattern(),difficulty:"advanced",meaning:"The most powerful yantra for manifesting spiritual and material abundance."},mandala_rose:{name:"Rose Mandala",description:"Heart-opening floral pattern",paths:this.generateRoseMandalaPattern(),difficulty:"beginner",meaning:"Opens the heart chakra and cultivates self-love and compassion."},cosmic_wheel:{name:"Cosmic Wheel",description:"Universe in eternal motion",paths:this.generateCosmicWheelPattern(),difficulty:"intermediate",meaning:"Represents the cycles of existence and cosmic consciousness."},tree_of_life:{name:"Tree of Life",description:"Connection between earth and sky",paths:this.generateTreeOfLifePattern(),difficulty:"advanced",meaning:"Symbolizes the connection between all forms of creation and spiritual growth."}},this.colorPalettes={chakra:{name:"Chakra Healing",colors:["#c41e3a","#ff8c00","#ffd700","#228b22","#4169e1","#663399","#9370db"],description:"Balance and align your energy centers"},nature:{name:"Nature Harmony",colors:["#8fbc8f","#deb887","#4682b4","#f4a460","#9370db","#20b2aa","#ffd700"],description:"Connect with the natural world"},sunset:{name:"Sunset Meditation",colors:["#ff4500","#ff6347","#ffd700","#ff69b4","#9370db","#4169e1","#191970"],description:"Evening contemplation and peace"},ocean:{name:"Ocean Depths",colors:["#e0ffff","#afeeee","#40e0d0","#20b2aa","#008b8b","#4682b4","#191970"],description:"Flow like water, deep like the sea"},earth:{name:"Earth Grounding",colors:["#f5deb3","#d2691e","#8b4513","#228b22","#556b2f","#8fbc8f","#2e8b57"],description:"Ground yourself in earthly wisdom"},crystal:{name:"Crystal Healing",colors:["#e6e6fa","#dda0dd","#da70d6","#ba55d3","#9932cc","#8a2be2","#4b0082"],description:"Crystal energy for clarity and healing"}},this.init()}async init(){console.log("üé® Initializing Mandala Coloring Canvas...");document.getElementById("mandalaColoringContainer")?(await this.createInterface(),this.setupCanvas(),this.initAudio(),this.bindEvents(),console.log("‚úÖ Mandala Coloring Canvas initialized")):console.warn("Mandala coloring container not found")}async createInterface(){document.getElementById("mandalaColoringContainer").innerHTML='\n            <div class="mandala-coloring-app">\n                \x3c!-- Header Controls --\x3e\n                <div class="mandala-header">\n                    <div class="mandala-title">\n                        <h3>üé® Mandala Coloring Canvas</h3>\n                        <p class="mandala-subtitle">Meditative Art & Sacred Geometry</p>\n                    </div>\n                    \n                    <div class="timer-display">\n                        <div class="timer-icon">üßò‚Äç‚ôÄÔ∏è</div>\n                        <div class="timer-text">\n                            <span id="meditationTime">00:00</span>\n                            <button id="timerToggle" class="timer-btn" title="Start/Pause Timer">‚ñ∂Ô∏è</button>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Main Content Area --\x3e\n                <div class="mandala-workspace">\n                    \x3c!-- Left Panel - Mandala Selection --\x3e\n                    <div class="mandala-panel left-panel">\n                        <h4>Choose Your Mandala</h4>\n                        <div class="mandala-grid" id="mandalaGrid">\n                            \x3c!-- Mandala thumbnails will be generated here --\x3e\n                        </div>\n                        \n                        <div class="current-mandala-info" id="mandalaInfo">\n                            <h5>Select a mandala to begin</h5>\n                            <p>Choose from our collection of sacred geometry patterns</p>\n                        </div>\n                    </div>\n\n                    \x3c!-- Center - Canvas Area --\x3e\n                    <div class="canvas-container">\n                        <div class="canvas-wrapper">\n                            <canvas id="mandalaCanvas" width="600" height="600"></canvas>\n                            <div class="canvas-overlay" id="canvasOverlay">\n                                <div class="start-message">\n                                    <div class="start-icon">üé®</div>\n                                    <h4>Select a Mandala Pattern</h4>\n                                    <p>Choose from the collection on the left to begin your meditative journey</p>\n                                </div>\n                            </div>\n                        </div>\n                        \n                        \x3c!-- Canvas Controls --\x3e\n                        <div class="canvas-controls">\n                            <button id="undoBtn" class="control-btn" title="Undo">‚Ü∂</button>\n                            <button id="redoBtn" class="control-btn" title="Redo">‚Ü∑</button>\n                            <button id="clearBtn" class="control-btn" title="Clear Canvas">üóëÔ∏è</button>\n                            <button id="saveBtn" class="control-btn" title="Save Image">üíæ</button>\n                            <button id="shareBtn" class="control-btn" title="Share">üì§</button>\n                        </div>\n                    </div>\n\n                    \x3c!-- Right Panel - Colors & Tools --\x3e\n                    <div class="mandala-panel right-panel">\n                        <h4>Color Palettes</h4>\n                        \n                        \x3c!-- Palette Selector --\x3e\n                        <div class="palette-selector">\n                            <select id="paletteSelect" class="palette-dropdown">\n                                <option value="chakra">üåà Chakra Healing</option>\n                                <option value="nature">üåø Nature Harmony</option>\n                                <option value="sunset">üåÖ Sunset Meditation</option>\n                                <option value="ocean">üåä Ocean Depths</option>\n                                <option value="earth">üåç Earth Grounding</option>\n                                <option value="crystal">üíé Crystal Healing</option>\n                            </select>\n                        </div>\n\n                        \x3c!-- Color Grid --\x3e\n                        <div class="color-grid" id="colorGrid">\n                            \x3c!-- Colors will be generated here --\x3e\n                        </div>\n\n                        <div class="palette-info" id="paletteInfo">\n                            \x3c!-- Palette description will appear here --\x3e\n                        </div>\n\n                        \x3c!-- Brush Controls --\x3e\n                        <div class="brush-controls">\n                            <h5>Brush Settings</h5>\n                            <div class="brush-size">\n                                <label>Size: <span id="brushSizeValue">8</span>px</label>\n                                <input type="range" id="brushSize" min="2" max="20" value="8" class="slider">\n                            </div>\n                        </div>\n\n                        \x3c!-- Audio Controls --\x3e\n                        <div class="audio-controls">\n                            <h5>Ambient Sounds</h5>\n                            <button id="audioToggle" class="audio-btn">üîä Enable Sounds</button>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Completion Celebration --\x3e\n                <div class="completion-celebration" id="completionModal" style="display: none;">\n                    <div class="celebration-content">\n                        <h3>üéâ Mandala Complete!</h3>\n                        <p>Your mindful creation is beautiful. You spent <span id="completionTime"></span> in meditation.</p>\n                        <div class="celebration-buttons">\n                            <button id="saveCompletedBtn" class="celebrate-btn">üíæ Save Creation</button>\n                            <button id="startNewBtn" class="celebrate-btn">üé® Create New</button>\n                            <button id="shareCompletedBtn" class="celebrate-btn">üì§ Share</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        ',this.generateMandalaGrid(),this.generateColorPalette("chakra")}setupCanvas(){this.canvas=document.getElementById("mandalaCanvas"),this.ctx=this.canvas.getContext("2d"),this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.imageSmoothingEnabled=!0,this.saveState()}generateLotusPattern(){const t=[],e=300,n=300;for(let a=0;a<8;a++){const i=a/8*Math.PI*2,s=`M ${e+120*Math.cos(i)} ${n+120*Math.sin(i)}\n                         Q ${e+80*Math.cos(i+.3)} ${n+80*Math.sin(i+.3)}\n                           ${e+120*Math.cos(i+.6)} ${n+120*Math.sin(i+.6)}\n                         Q 300 300 \n                           ${e+120*Math.cos(i)} ${n+120*Math.sin(i)}`;t.push({d:s,id:`lotus-outer-${a}`})}for(let a=0;a<6;a++){const i=a/6*Math.PI*2,s=`M ${e+60*Math.cos(i)} ${n+60*Math.sin(i)}\n                         Q ${e+40*Math.cos(i+.5)} ${n+40*Math.sin(i+.5)}\n                           ${e+60*Math.cos(i+1)} ${n+60*Math.sin(i+1)}\n                         Q 300 300\n                           ${e+60*Math.cos(i)} ${n+60*Math.sin(i)}`;t.push({d:s,id:`lotus-inner-${a}`})}return t.push({d:"M 320 300 A 20 20 0 1 1 280 300 A 20 20 0 1 1 320 300",id:"lotus-center"}),t}generateFlowerOfLifePattern(){const t=[],e=300,n=300,a=40;t.push({d:"M 340 300 A 40 40 0 1 1 260 300 A 40 40 0 1 1 340 300",id:"fol-center"});for(let i=0;i<6;i++){const s=i/6*Math.PI*2,o=e+Math.cos(s)*a,r=n+Math.sin(s)*a;t.push({d:`M ${o+a} ${r} A 40 40 0 1 1 ${o-a} ${r} A 40 40 0 1 1 ${o+a} ${r}`,id:`fol-ring1-${i}`})}for(let i=0;i<12;i++){const s=i/12*Math.PI*2,o=e+80*Math.cos(s),r=n+80*Math.sin(s);t.push({d:`M ${o+a} ${r} A 40 40 0 1 1 ${o-a} ${r} A 40 40 0 1 1 ${o+a} ${r}`,id:`fol-ring2-${i}`})}return t}generateSriYantraPattern(){const t=[],e=300,n=300;for(let a=0;a<4;a++){const i=150-20*a,s=`M 300 ${n-i} \n                         L ${e-.866*i} ${n+.5*i}\n                         L ${e+.866*i} ${n+.5*i} Z`;t.push({d:s,id:`yantra-up-${a}`})}for(let a=0;a<5;a++){const i=140-18*a,s=`M 300 ${n+i}\n                         L ${e-.866*i} ${n-.5*i}\n                         L ${e+.866*i} ${n-.5*i} Z`;t.push({d:s,id:`yantra-down-${a}`})}return t.push({d:"M 305 300 A 5 5 0 1 1 295 300 A 5 5 0 1 1 305 300",id:"yantra-center"}),t}generateRoseMandalaPattern(){const t=[];for(let e=0;e<3;e++){const n=120-30*e,a=8+4*e;for(let i=0;i<a;i++){const s=i/a*Math.PI*2,o=300+Math.cos(s)*n,r=300+Math.sin(s)*n,l=`M ${o} ${r}\n                             Q ${o+20*Math.cos(s+.2)} ${r+20*Math.sin(s+.2)}\n                               ${o+15*Math.cos(s+.4)} ${r+15*Math.sin(s+.4)}\n                             Q ${o+20*Math.cos(s-.2)} ${r+20*Math.sin(s-.2)}\n                               ${o} ${r}`;t.push({d:l,id:`rose-ring${e}-${i}`})}}return t}generateCosmicWheelPattern(){const t=[],e=300,n=300;for(let n=1;n<=5;n++){const a=30*n;t.push({d:`M ${e+a} 300 A ${a} ${a} 0 1 1 ${e-a} 300 A ${a} ${a} 0 1 1 ${e+a} 300`,id:`cosmic-circle-${n}`})}for(let a=0;a<12;a++){const i=a/12*Math.PI*2,s=`M 300 300 L ${e+150*Math.cos(i)} ${n+150*Math.sin(i)}`;t.push({d:s,id:`cosmic-spoke-${a}`})}return t}generateTreeOfLifePattern(){const t=[],e=300;t.push({d:"M 290 450 L 310 450 L 315 250 L 285 250 Z",id:"tree-trunk"});for(let n=0;n<8;n++){const a=n/8*Math.PI*2,i=80+40*Math.random(),s=`M 300 250 L ${e+Math.cos(a)*i} ${250+Math.sin(a)*i}`;t.push({d:s,id:`tree-branch-${n}`});const o=e+Math.cos(a)*i,r=250+Math.sin(a)*i;for(let e=0;e<5;e++){const i=a+.3*(e-2),s=`M ${o} ${r} Q ${o+15*Math.cos(i)} ${r+15*Math.sin(i)} ${o+25*Math.cos(i+.5)} ${r+25*Math.sin(i+.5)}`;t.push({d:s,id:`tree-leaf-${n}-${e}`})}}return t}generateMandalaGrid(){const t=document.getElementById("mandalaGrid");Object.entries(this.mandalaPatterns).forEach(([e,n])=>{const a=document.createElement("div");a.className="mandala-tile",a.dataset.mandala=e,a.innerHTML=`\n                <div class="mandala-preview">\n                    <svg width="80" height="80" viewBox="0 0 600 600">\n                        ${n.paths.map(t=>`<path d="${t.d}" stroke="#666" stroke-width="1" fill="none" />`).join("")}\n                    </svg>\n                </div>\n                <div class="mandala-name">${n.name}</div>\n                <div class="mandala-difficulty ${n.difficulty}">${n.difficulty}</div>\n            `,a.addEventListener("click",()=>this.selectMandala(e)),t.appendChild(a)})}generateColorPalette(t){const e=this.colorPalettes[t],n=document.getElementById("colorGrid"),a=document.getElementById("paletteInfo");n.innerHTML="",e.colors.forEach(t=>{const e=document.createElement("div");e.className="color-tile",e.style.backgroundColor=t,e.dataset.color=t,e.title=t,t===this.currentColor&&e.classList.add("selected"),e.addEventListener("click",()=>this.selectColor(t)),n.appendChild(e)}),a.innerHTML=`\n            <h6>${e.name}</h6>\n            <p>${e.description}</p>\n        `}bindEvents(){this.canvas.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvas.addEventListener("mousemove",this.draw.bind(this)),this.canvas.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvas.addEventListener("mouseout",this.stopDrawing.bind(this)),this.canvas.addEventListener("touchstart",this.handleTouch.bind(this)),this.canvas.addEventListener("touchmove",this.handleTouch.bind(this)),this.canvas.addEventListener("touchend",this.stopDrawing.bind(this)),document.getElementById("undoBtn").addEventListener("click",this.undo.bind(this)),document.getElementById("redoBtn").addEventListener("click",this.redo.bind(this)),document.getElementById("clearBtn").addEventListener("click",this.clearCanvas.bind(this)),document.getElementById("saveBtn").addEventListener("click",this.saveImage.bind(this)),document.getElementById("shareBtn").addEventListener("click",this.shareImage.bind(this)),document.getElementById("paletteSelect").addEventListener("change",t=>{this.currentPalette=t.target.value,this.generateColorPalette(this.currentPalette)}),document.getElementById("brushSize").addEventListener("input",t=>{this.brushSize=parseInt(t.target.value),document.getElementById("brushSizeValue").textContent=this.brushSize}),document.getElementById("timerToggle").addEventListener("click",this.toggleTimer.bind(this)),document.getElementById("audioToggle").addEventListener("click",this.toggleAudio.bind(this)),document.getElementById("saveCompletedBtn").addEventListener("click",this.saveImage.bind(this)),document.getElementById("startNewBtn").addEventListener("click",this.startNewMandala.bind(this)),document.getElementById("shareCompletedBtn").addEventListener("click",this.shareImage.bind(this))}selectMandala(t){this.currentMandala=t;const e=this.mandalaPatterns[t];document.querySelectorAll(".mandala-tile").forEach(t=>{t.classList.remove("selected")}),document.querySelector(`[data-mandala="${t}"]`).classList.add("selected"),document.getElementById("mandalaInfo").innerHTML=`\n            <h5>${e.name}</h5>\n            <p class="mandala-description">${e.description}</p>\n            <p class="mandala-meaning">${e.meaning}</p>\n            <div class="difficulty-badge ${e.difficulty}">${e.difficulty}</div>\n        `,this.drawMandalaOutline(e),document.getElementById("canvasOverlay").style.display="none",console.log(`Selected mandala: ${e.name}`)}selectColor(t){this.currentColor=t,document.querySelectorAll(".color-tile").forEach(t=>{t.classList.remove("selected")}),document.querySelector(`[data-color="${t}"]`).classList.add("selected"),console.log(`Selected color: ${t}`)}drawMandalaOutline(t){this.clearCanvas(),this.ctx.strokeStyle="#e0e0e0",this.ctx.lineWidth=1,this.ctx.fillStyle="transparent",t.paths.forEach(t=>{const e=new Path2D(t.d);this.ctx.stroke(e)}),this.saveState()}startDrawing(t){if(!this.currentMandala)return;this.isDrawing=!0,this.startTimer();const e=this.canvas.getBoundingClientRect(),n=t.clientX-e.left,a=t.clientY-e.top;this.ctx.beginPath(),this.ctx.moveTo(n,a),this.playDrawingSound()}draw(t){if(!this.isDrawing||!this.currentMandala)return;const e=this.canvas.getBoundingClientRect(),n=t.clientX-e.left,a=t.clientY-e.top;this.ctx.globalCompositeOperation="source-over",this.ctx.lineWidth=this.brushSize,this.ctx.strokeStyle=this.currentColor,this.ctx.lineTo(n,a),this.ctx.stroke()}stopDrawing(){this.isDrawing&&(this.isDrawing=!1,this.ctx.beginPath(),this.saveState(),this.checkCompletion())}handleTouch(t){t.preventDefault();const e=t.touches[0],n=new MouseEvent("touchstart"===t.type?"mousedown":"touchmove"===t.type?"mousemove":"mouseup",{clientX:e.clientX,clientY:e.clientY});this.canvas.dispatchEvent(n)}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentMandala&&this.drawMandalaOutline(this.mandalaPatterns[this.currentMandala]),this.saveState()}saveState(){this.historyStep++,this.historyStep<this.drawingHistory.length&&(this.drawingHistory.length=this.historyStep),this.drawingHistory.push(this.canvas.toDataURL()),this.drawingHistory.length>20&&(this.drawingHistory.shift(),this.historyStep--)}undo(){this.historyStep>0&&(this.historyStep--,this.restoreState())}redo(){this.historyStep<this.drawingHistory.length-1&&(this.historyStep++,this.restoreState())}restoreState(){const t=new Image;t.onload=()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(t,0,0)},t.src=this.drawingHistory[this.historyStep]}startTimer(){this.isTimerRunning||(this.isTimerRunning=!0,document.getElementById("timerToggle").textContent="‚è∏Ô∏è",this.timerInterval=setInterval(()=>{this.meditationTimer++,this.updateTimerDisplay()},1e3))}toggleTimer(){this.isTimerRunning?this.pauseTimer():this.startTimer()}pauseTimer(){this.isTimerRunning=!1,document.getElementById("timerToggle").textContent="‚ñ∂Ô∏è",this.timerInterval&&clearInterval(this.timerInterval)}updateTimerDisplay(){const t=Math.floor(this.meditationTimer/60),e=this.meditationTimer%60,n=`${t.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`;document.getElementById("meditationTime").textContent=n}async initAudio(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch(t){console.log("Audio not available:",t),this.audioEnabled=!1}}toggleAudio(){this.audioEnabled=!this.audioEnabled;const t=document.getElementById("audioToggle");this.audioEnabled?(t.textContent="üîä Sounds On",this.startAmbientSound()):(t.textContent="üîá Sounds Off",this.stopAmbientSound())}playDrawingSound(){if(!this.audioEnabled||!this.audioContext)return;const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.connect(e),e.connect(this.audioContext.destination),t.frequency.setValueAtTime(200+100*Math.random(),this.audioContext.currentTime),t.type="sine",e.gain.setValueAtTime(0,this.audioContext.currentTime),e.gain.linearRampToValueAtTime(.1,this.audioContext.currentTime+.01),e.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+.2),t.start(),t.stop(this.audioContext.currentTime+.2)}startAmbientSound(){this.audioEnabled&&this.audioContext&&console.log("üéµ Starting ambient meditation sounds")}stopAmbientSound(){this.ambientSound&&(this.ambientSound.stop(),this.ambientSound=null),console.log("üîá Stopping ambient sounds")}checkCompletion(){const t=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data;let e=0;for(let n=3;n<t.length;n+=4)t[n]>0&&e++;e/(this.canvas.width*this.canvas.height)*100>15&&this.showCompletionCelebration()}showCompletionCelebration(){this.pauseTimer();const t=document.getElementById("completionModal"),e=document.getElementById("completionTime"),n=Math.floor(this.meditationTimer/60),a=this.meditationTimer%60;e.textContent=`${n}m ${a}s`,t.style.display="flex",this.createParticleCelebration(),this.playCompletionSound(),console.log("üéâ Mandala completion celebrated!")}createParticleCelebration(){const t=document.querySelector(".mandala-coloring-app");for(let e=0;e<30;e++)setTimeout(()=>{const e=document.createElement("div");e.className="celebration-particle",e.style.cssText=`\n                    position: absolute;\n                    width: 8px;\n                    height: 8px;\n                    background: ${this.colorPalettes[this.currentPalette].colors[Math.floor(Math.random()*this.colorPalettes[this.currentPalette].colors.length)]};\n                    border-radius: 50%;\n                    pointer-events: none;\n                    z-index: 1000;\n                    left: ${100*Math.random()}%;\n                    top: ${100*Math.random()}%;\n                    animation: celebrationFloat 3s ease-out forwards;\n                `,t.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},3e3)},50*e)}playCompletionSound(){if(!this.audioEnabled||!this.audioContext)return;[261.63,329.63,392].forEach((t,e)=>{setTimeout(()=>{const e=this.audioContext.createOscillator(),n=this.audioContext.createGain();e.connect(n),n.connect(this.audioContext.destination),e.frequency.setValueAtTime(t,this.audioContext.currentTime),e.type="sine",n.gain.setValueAtTime(0,this.audioContext.currentTime),n.gain.linearRampToValueAtTime(.1,this.audioContext.currentTime+.1),n.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+1),e.start(),e.stop(this.audioContext.currentTime+1)},200*e)})}saveImage(){const t=document.createElement("a");t.download=`mandala-${this.currentMandala}-${Date.now()}.png`,t.href=this.canvas.toDataURL(),t.click(),console.log("üíæ Mandala saved")}shareImage(){this.canvas.toBlob(t=>{const e=[new File([t],"mandala.png",{type:"image/png"})];navigator.canShare&&navigator.canShare({files:e})?navigator.share({files:e,title:"My Meditation Mandala",text:"I created this beautiful mandala during my meditation practice!"}):(this.saveImage(),alert("Image saved! Share it with your friends."))})}startNewMandala(){document.getElementById("completionModal").style.display="none",this.meditationTimer=0,this.updateTimerDisplay(),this.pauseTimer(),this.clearCanvas(),this.currentMandala=null,document.getElementById("canvasOverlay").style.display="flex",document.querySelectorAll(".mandala-tile").forEach(t=>{t.classList.remove("selected")}),console.log("üé® Ready for new mandala")}destroy(){this.timerInterval&&clearInterval(this.timerInterval),this.audioContext&&this.audioContext.close(),console.log("üé® Mandala Coloring Canvas destroyed")}}if(!document.getElementById("mandalaStyles")){const t=document.createElement("style");t.id="mandalaStyles",t.textContent=`\n        @keyframes celebrationFloat {\n            0% {\n                transform: translate(0, 0) scale(1) rotate(0deg);\n                opacity: 1;\n            }\n            50% {\n                transform: translate(${200*Math.random()-100}px, ${200*Math.random()-100}px) scale(1.5) rotate(180deg);\n                opacity: 0.8;\n            }\n            100% {\n                transform: translate(${400*Math.random()-200}px, ${400*Math.random()-200}px) scale(0) rotate(360deg);\n                opacity: 0;\n            }\n        }\n        \n        .celebration-particle {\n            animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);\n        }\n    `,document.head.appendChild(t)}document.addEventListener("DOMContentLoaded",()=>{document.getElementById("mandalaColoringContainer")&&(console.log("üé® Initializing Mandala Coloring Canvas..."),window.mandalaColoringCanvas=new MandalaColoringCanvas)}),window.addEventListener("beforeunload",()=>{window.mandalaColoringCanvas&&window.mandalaColoringCanvas.destroy()});