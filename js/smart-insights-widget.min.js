class SmartInsightsWidget{constructor(n="smart-insights-widget"){this.containerId=n,this.insights=null,this.init()}async init(){console.log("üìä Initializing Smart Insights Widget..."),await this.waitForInsightsSystem(),this.loadInsights(),window.addEventListener("insightsUpdated",()=>this.refresh()),this.render(),console.log("‚úÖ Smart Insights Widget ready")}async waitForInsightsSystem(){return new Promise(n=>{const e=()=>{window.smartInsights&&window.smartInsights.isInitialized?n():setTimeout(e,100)};e()})}loadInsights(){window.smartInsights&&(this.insights=window.smartInsights.getInsights())}refresh(){this.loadInsights(),this.render()}render(){const n=document.getElementById(this.containerId);n&&(this.insights?n.innerHTML=`\n            ${this.getStyles()}\n            <div class="smart-insights-widget">\n                <div class="insights-header">\n                    <span class="insights-icon">üìä</span>\n                    <span>Your Insights</span>\n                </div>\n\n                ${this.renderWeeklySummary()}\n                ${this.renderPatterns()}\n                ${this.renderRecommendations()}\n            </div>\n        `:n.innerHTML='\n                <div class="smart-insights-widget">\n                    <div style="text-align: center; padding: 2rem; color: rgba(255,255,255,0.6);">\n                        Loading insights...\n                    </div>\n                </div>\n            ')}renderWeeklySummary(){const{weeklyGrowth:n}=this.insights.trends,e="up"===n.trend?"üìà":"down"===n.trend?"üìâ":"‚û°Ô∏è",t="up"===n.trend?"#66bb6a":"down"===n.trend?"#ff6b6b":"#4fc3f7";return`\n            <div class="insight-card weekly-summary">\n                <div class="insight-card-header">\n                    <span>üìÖ</span>\n                    <span>This Week</span>\n                </div>\n                <div class="weekly-stats">\n                    <div class="weekly-stat">\n                        <div class="weekly-stat-value">${n.thisWeek.toLocaleString()}</div>\n                        <div class="weekly-stat-label">XP Earned</div>\n                    </div>\n                    <div class="weekly-growth" style="color: ${t};">\n                        <span class="growth-icon">${e}</span>\n                        <span class="growth-value">${Math.abs(n.growth)}%</span>\n                    </div>\n                </div>\n            </div>\n        `}renderPatterns(){const{bestDay:n,peakTime:e,streakQuality:t}=this.insights.patterns;return`\n            <div class="insight-card patterns-card">\n                <div class="insight-card-header">\n                    <span>üîç</span>\n                    <span>Your Patterns</span>\n                </div>\n                <div class="patterns-list">\n                    <div class="pattern-item">\n                        <div class="pattern-label">üî• Best Day</div>\n                        <div class="pattern-value">${n.name}</div>\n                    </div>\n                    <div class="pattern-item">\n                        <div class="pattern-label">‚è∞ Peak Time</div>\n                        <div class="pattern-value">${e.range}</div>\n                    </div>\n                    <div class="pattern-item">\n                        <div class="pattern-label">${t.emoji} Streak</div>\n                        <div class="pattern-value">${t.quality}</div>\n                    </div>\n                </div>\n            </div>\n        `}renderRecommendations(){if(!this.insights.recommendations||0===this.insights.recommendations.length)return"";return`\n            <div class="insight-card recommendations-card">\n                <div class="insight-card-header">\n                    <span>üí°</span>\n                    <span>Recommendations</span>\n                </div>\n                <div class="recommendations-list">\n                    ${this.insights.recommendations.slice(0,3).map(n=>this.renderRecommendation(n)).join("")}\n                </div>\n            </div>\n        `}renderRecommendation(n){return`\n            <div class="recommendation-item ${"high"===n.priority?"high-priority":"medium"===n.priority?"medium-priority":"low-priority"}">\n                <div class="rec-icon">${n.icon}</div>\n                <div class="rec-content">\n                    <div class="rec-title">${n.title}</div>\n                    <div class="rec-message">${n.message}</div>\n                </div>\n            </div>\n        `}getStyles(){return"\n            <style>\n                .smart-insights-widget {\n                    background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(212, 175, 55, 0.1));\n                    backdrop-filter: blur(20px);\n                    border: 1px solid rgba(255, 255, 255, 0.1);\n                    border-radius: 20px;\n                    padding: 2rem;\n                    margin-bottom: 2rem;\n                }\n\n                .insights-header {\n                    display: flex;\n                    align-items: center;\n                    gap: 0.5rem;\n                    font-size: 1.5rem;\n                    font-weight: 700;\n                    color: #8B5CF6;\n                    margin-bottom: 1.5rem;\n                }\n\n                .insights-icon {\n                    font-size: 1.8rem;\n                }\n\n                .insight-card {\n                    background: rgba(255, 255, 255, 0.05);\n                    border: 1px solid rgba(255, 255, 255, 0.1);\n                    border-radius: 15px;\n                    padding: 1.5rem;\n                    margin-bottom: 1rem;\n                }\n\n                .insight-card:last-child {\n                    margin-bottom: 0;\n                }\n\n                .insight-card-header {\n                    display: flex;\n                    align-items: center;\n                    gap: 0.5rem;\n                    font-weight: 700;\n                    color: white;\n                    margin-bottom: 1rem;\n                    font-size: 1.1rem;\n                }\n\n                .weekly-summary {\n                    background: linear-gradient(135deg, rgba(79, 195, 247, 0.1), rgba(102, 187, 106, 0.1));\n                }\n\n                .weekly-stats {\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                }\n\n                .weekly-stat-value {\n                    font-size: 2rem;\n                    font-weight: 700;\n                    color: #4fc3f7;\n                    margin-bottom: 0.25rem;\n                }\n\n                .weekly-stat-label {\n                    font-size: 0.9rem;\n                    color: rgba(255, 255, 255, 0.6);\n                }\n\n                .weekly-growth {\n                    display: flex;\n                    align-items: center;\n                    gap: 0.5rem;\n                    font-size: 1.5rem;\n                    font-weight: 700;\n                }\n\n                .growth-icon {\n                    font-size: 2rem;\n                }\n\n                .patterns-list {\n                    display: flex;\n                    flex-direction: column;\n                    gap: 0.75rem;\n                }\n\n                .pattern-item {\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                    padding: 0.75rem;\n                    background: rgba(255, 255, 255, 0.05);\n                    border-radius: 10px;\n                }\n\n                .pattern-label {\n                    color: rgba(255, 255, 255, 0.7);\n                    font-size: 0.9rem;\n                }\n\n                .pattern-value {\n                    color: white;\n                    font-weight: 700;\n                    font-size: 1rem;\n                }\n\n                .recommendations-list {\n                    display: flex;\n                    flex-direction: column;\n                    gap: 1rem;\n                }\n\n                .recommendation-item {\n                    display: flex;\n                    gap: 1rem;\n                    padding: 1rem;\n                    background: rgba(255, 255, 255, 0.05);\n                    border-radius: 12px;\n                    border-left: 4px solid transparent;\n                    transition: all 0.3s ease;\n                }\n\n                .recommendation-item:hover {\n                    background: rgba(255, 255, 255, 0.08);\n                    transform: translateX(5px);\n                }\n\n                .recommendation-item.high-priority {\n                    border-left-color: #ff6b6b;\n                }\n\n                .recommendation-item.medium-priority {\n                    border-left-color: #feca57;\n                }\n\n                .recommendation-item.low-priority {\n                    border-left-color: #4fc3f7;\n                }\n\n                .rec-icon {\n                    font-size: 2rem;\n                    flex-shrink: 0;\n                }\n\n                .rec-content {\n                    flex: 1;\n                }\n\n                .rec-title {\n                    font-weight: 700;\n                    color: white;\n                    margin-bottom: 0.25rem;\n                    font-size: 1rem;\n                }\n\n                .rec-message {\n                    color: rgba(255, 255, 255, 0.7);\n                    font-size: 0.9rem;\n                    line-height: 1.4;\n                }\n\n                @media (max-width: 768px) {\n                    .smart-insights-widget {\n                        padding: 1.5rem;\n                    }\n\n                    .weekly-stats {\n                        flex-direction: column;\n                        align-items: flex-start;\n                        gap: 1rem;\n                    }\n\n                    .recommendation-item {\n                        flex-direction: column;\n                        align-items: flex-start;\n                    }\n\n                    .rec-icon {\n                        font-size: 2.5rem;\n                    }\n                }\n            </style>\n        "}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{document.getElementById("smart-insights-widget")&&(window.smartInsightsWidget=new SmartInsightsWidget)}):document.getElementById("smart-insights-widget")&&(window.smartInsightsWidget=new SmartInsightsWidget),console.log("üìä Smart Insights Widget loaded");