class VideoLibrarySystem{constructor(){this.videoLibrary=this.loadVideoLibrary(),this.watchHistory=this.loadWatchHistory(),this.savedProgress=this.loadSavedProgress(),this.playlists=this.loadPlaylists(),this.favorites=this.loadFavorites(),this.currentVideo=null,this.player=null,this.init()}init(){console.log("ðŸ“º Video Library System initialized"),this.setupProgressTracking()}loadVideoLibrary(){return{courses:[{id:"course-1",title:"30-Day Meditation Mastery",description:"Complete meditation course from beginner to advanced",instructor:"Master Meditation Teacher",level:"All Levels",duration:36e3,thumbnail:"/img/videos/meditation-course.jpg",videos:[{id:"course-1-v1",title:"Day 1: Introduction to Meditation",duration:1200,videoUrl:"https://youtube.com/embed/xyz123",type:"youtube"},{id:"course-1-v2",title:"Day 2: Breath Awareness",duration:1200,videoUrl:"https://youtube.com/embed/xyz124",type:"youtube"}],tags:["meditation","course","mindfulness"],rating:4.9,enrollments:5432},{id:"course-2",title:"Yoga for Spiritual Awakening",description:"21-day transformational yoga journey",instructor:"Yoga Master",level:"Intermediate",duration:25200,thumbnail:"/img/videos/yoga-course.jpg",videos:[{id:"course-2-v1",title:"Day 1: Foundation Poses",duration:1800,videoUrl:"https://youtube.com/embed/abc123",type:"youtube"}],tags:["yoga","awakening","transformation"],rating:4.8,enrollments:3210}],teachings:[{id:"teaching-1",title:"The Nature of Consciousness",description:"Deep dive into consciousness and awareness",teacher:"Spiritual Master",duration:5400,thumbnail:"/img/videos/consciousness.jpg",videoUrl:"https://youtube.com/embed/def456",type:"youtube",tags:["consciousness","philosophy","awakening"],views:125e3,rating:4.9},{id:"teaching-2",title:"Understanding Karma",description:"The law of cause and effect explained",teacher:"Dharma Teacher",duration:3600,thumbnail:"/img/videos/karma.jpg",videoUrl:"https://youtube.com/embed/ghi789",type:"youtube",tags:["karma","buddhism","philosophy"],views:98e3,rating:4.7}],meditations:[{id:"meditation-1",title:"Guided Body Scan Meditation",description:"Full body relaxation and awareness",guide:"Calm Voice",duration:1200,thumbnail:"/img/videos/body-scan.jpg",videoUrl:"https://youtube.com/embed/jkl012",type:"youtube",difficulty:"Beginner",tags:["meditation","relaxation","body scan"],views:25e4},{id:"meditation-2",title:"Chakra Activation Meditation",description:"Activate and balance all seven chakras",guide:"Energy Healer",duration:2100,thumbnail:"/img/videos/chakra-activation.jpg",videoUrl:"https://youtube.com/embed/mno345",type:"youtube",difficulty:"Intermediate",tags:["meditation","chakras","energy"],views:18e4}],rituals:[{id:"ritual-1",title:"Full Moon Ceremony",description:"Sacred ritual for the full moon",guide:"Moon Priestess",duration:1800,thumbnail:"/img/videos/full-moon.jpg",videoUrl:"https://youtube.com/embed/pqr678",type:"youtube",tags:["ritual","moon","ceremony"],views:75e3},{id:"ritual-2",title:"Sacred Smudging Ceremony",description:"Learn the art of energy clearing with sage",guide:"Shaman",duration:900,thumbnail:"/img/videos/smudging.jpg",videoUrl:"https://youtube.com/embed/stu901",type:"youtube",tags:["ritual","cleansing","smudging"],views:92e3}],documentaries:[{id:"doc-1",title:"The Awakening: A Spiritual Journey",description:"Documentary following spiritual seekers around the world",duration:7200,thumbnail:"/img/videos/awakening-doc.jpg",videoUrl:"https://youtube.com/embed/vwx234",type:"youtube",tags:["documentary","spirituality","journey"],views:5e5,rating:4.9}],liveStreams:[{id:"live-1",title:"Weekly Group Meditation",description:"Join us live every Sunday at 7 PM",guide:"Community Leader",schedule:"Sunday 7:00 PM EST",thumbnail:"/img/videos/group-meditation.jpg",streamUrl:"https://youtube.com/live/abc",type:"youtube-live",tags:["live","meditation","community"],recurring:!0}]}}getAllVideos(){const e=[];for(const t in this.videoLibrary)"courses"===t?this.videoLibrary.courses.forEach(t=>{t.videos.forEach(i=>{e.push({...i,courseId:t.id,courseTitle:t.title})})}):e.push(...this.videoLibrary[t]);return e}getVideoById(e){for(const t of this.videoLibrary.courses){const i=t.videos.find(t=>t.id===e);if(i)return{...i,courseId:t.id,courseTitle:t.title,instructor:t.instructor}}for(const t in this.videoLibrary)if("courses"!==t){const i=this.videoLibrary[t].find(t=>t.id===e);if(i)return i}return null}getCourseById(e){return this.videoLibrary.courses.find(t=>t.id===e)}getVideosByCategory(e){return"all"===e?this.getAllVideos():this.videoLibrary[e]||[]}async watchVideo(e){const t=this.getVideoById(e);if(!t)return{success:!1,message:"Video not found"};this.currentVideo=t,this.addToWatchHistory(t);const i=this.savedProgress[e];return i&&console.log(`Resuming from ${i.position}s`),window.progressSystem&&(window.progressSystem.awardXP(15,`Started watching: ${t.title}`,"videos"),window.progressSystem.logActivity("video_started","videos",{videoId:t.id,title:t.title})),{success:!0,video:t}}saveProgress(e,t,i){this.savedProgress[e]={position:t,duration:i,percentage:t/i*100,lastWatched:(new Date).toISOString()},localStorage.setItem("video_progress",JSON.stringify(this.savedProgress));const o=Math.floor(t/i*100),s=`video_milestone_${e}`,r=parseInt(localStorage.getItem(s)||"0");o>=50&&r<50?(window.progressSystem&&window.progressSystem.awardXP(10,"Halfway through video","videos"),localStorage.setItem(s,"50")):o>=90&&r<90&&this.markAsCompleted(e)}markAsCompleted(e){const t=this.getVideoById(e);if(!t)return;const i=`video_completed_${e}`;if(localStorage.getItem(i))return;let o=30;t.duration>=3600?o+=50:t.duration>=1800?o+=30:t.duration>=600&&(o+=15),t.courseId&&(o+=20),window.progressSystem&&(window.progressSystem.awardXP(o,`Completed: ${t.title}`,"videos"),window.progressSystem.logActivity("video_completed","videos",{videoId:t.id,duration:t.duration})),localStorage.setItem(i,"true"),t.courseId&&this.checkCourseCompletion(t.courseId)}checkCourseCompletion(e){const t=this.getCourseById(e);if(!t)return;if(t.videos.every(e=>localStorage.getItem(`video_completed_${e.id}`))){const i=`course_completed_${e}`;localStorage.getItem(i)||(window.progressSystem&&window.progressSystem.awardXP(500,`Course Completed: ${t.title}! ðŸŽ“`,"videos"),localStorage.setItem(i,"true"),this.showCourseCompletionBadge(t))}}showCourseCompletionBadge(e){const t=document.createElement("div");t.className="course-completion-badge",t.innerHTML=`\n            <div class="badge-content">\n                <div class="badge-icon">ðŸŽ“</div>\n                <h3>Course Completed!</h3>\n                <p>${e.title}</p>\n                <p class="badge-xp">+500 XP</p>\n                <p class="badge-message">Congratulations on completing this transformational journey!</p>\n            </div>\n        `,document.body.appendChild(t),setTimeout(()=>t.remove(),8e3)}isCompleted(e){return"true"===localStorage.getItem(`video_completed_${e}`)}isCourseCompleted(e){return"true"===localStorage.getItem(`course_completed_${e}`)}getCourseProgress(e){const t=this.getCourseById(e);if(!t)return 0;return t.videos.filter(e=>this.isCompleted(e.id)).length/t.videos.length*100}addToWatchHistory(e){const t={videoId:e.id,title:e.title,thumbnail:e.thumbnail,timestamp:(new Date).toISOString()};this.watchHistory.unshift(t),this.watchHistory.length>100&&(this.watchHistory=this.watchHistory.slice(0,100)),this.saveWatchHistory()}toggleFavorite(e){const t=this.favorites.indexOf(e);return-1===t?(this.favorites.push(e),window.progressSystem&&window.progressSystem.awardXP(5,"Added to favorites","videos")):this.favorites.splice(t,1),this.saveFavorites(),this.favorites.includes(e)}isFavorite(e){return this.favorites.includes(e)}getFavorites(){return this.favorites.map(e=>this.getVideoById(e)).filter(e=>null!==e)}createPlaylist(e,t=[]){const i={id:Date.now().toString(),name:e,videos:t,createdAt:(new Date).toISOString(),thumbnail:null};return this.playlists.push(i),this.savePlaylists(),window.progressSystem&&window.progressSystem.awardXP(20,`Created playlist: ${e}`,"videos"),i}addToPlaylist(e,t){const i=this.playlists.find(t=>t.id===e);return!(!i||i.videos.includes(t))&&(i.videos.push(t),this.savePlaylists(),!0)}removeFromPlaylist(e,t){const i=this.playlists.find(t=>t.id===e);return!!i&&(i.videos=i.videos.filter(e=>e!==t),this.savePlaylists(),!0)}deletePlaylist(e){this.playlists=this.playlists.filter(t=>t.id!==e),this.savePlaylists()}getPlaylist(e){const t=this.playlists.find(t=>t.id===e);return t?{...t,videos:t.videos.map(e=>this.getVideoById(e)).filter(e=>null!==e)}:null}getRecommendations(e=10){const t={};this.watchHistory.forEach(e=>{const i=this.getVideoById(e.videoId);i&&i.tags&&i.tags.forEach(e=>{t[e]=(t[e]||0)+1})});const i=Object.entries(t).sort((e,t)=>t[1]-e[1]).slice(0,3).map(([e])=>e);return this.getAllVideos().filter(e=>!this.isCompleted(e.id)&&(!!e.tags&&e.tags.some(e=>i.includes(e)))).slice(0,e)}enrollInCourse(e){const t=this.getCourseById(e);if(!t)return!1;const i=`course_enrolled_${e}`;return!localStorage.getItem(i)&&(localStorage.setItem(i,(new Date).toISOString()),window.progressSystem&&window.progressSystem.awardXP(50,`Enrolled in: ${t.title}`,"videos"),!0)}isEnrolled(e){return null!==localStorage.getItem(`course_enrolled_${e}`)}getEnrolledCourses(){return this.videoLibrary.courses.filter(e=>this.isEnrolled(e.id))}setupProgressTracking(){setInterval(()=>{if(this.currentVideo&&this.player){const e=this.getCurrentPosition(),t=this.currentVideo.duration;e&&t&&this.saveProgress(this.currentVideo.id,e,t)}},1e4)}getCurrentPosition(){return 0}getStats(){const e=this.watchHistory.length,t=this.getAllVideos().filter(e=>this.isCompleted(e.id)).length,i=this.favorites.length,o=this.playlists.length,s=this.getEnrolledCourses().length,r=this.videoLibrary.courses.filter(e=>this.isCourseCompleted(e.id)).length,a=Object.values(this.savedProgress).reduce((e,t)=>e+t.position,0);return{totalWatched:e,totalCompleted:t,totalFavorites:i,totalPlaylists:o,enrolledCourses:s,completedCourses:r,watchTimeHours:Math.floor(a/3600)}}loadWatchHistory(){const e=localStorage.getItem("video_watch_history");return e?JSON.parse(e):[]}saveWatchHistory(){localStorage.setItem("video_watch_history",JSON.stringify(this.watchHistory))}loadSavedProgress(){const e=localStorage.getItem("video_progress");return e?JSON.parse(e):{}}loadPlaylists(){const e=localStorage.getItem("video_playlists");return e?JSON.parse(e):[]}savePlaylists(){localStorage.setItem("video_playlists",JSON.stringify(this.playlists))}loadFavorites(){const e=localStorage.getItem("video_favorites");return e?JSON.parse(e):[]}saveFavorites(){localStorage.setItem("video_favorites",JSON.stringify(this.favorites))}formatDuration(e){const t=Math.floor(e/3600),i=Math.floor(e%3600/60);return t>0?`${t}h ${i}m`:`${i}m`}}"undefined"!=typeof window&&(window.videoLibrarySystem=new VideoLibrarySystem,console.log("ðŸ“º Video Library System ready!"));