class AccessibilityManager{constructor(){this.focusTrap=null,this.announcements=[],this.keyboardNavigation=!0,this.highContrastMode=!1,this.screenReaderActive=this.detectScreenReader(),this.init()}init(){this.setupAccessibilityFeatures(),this.setupKeyboardNavigation(),this.setupFocusManagement(),this.setupScreenReaderSupport(),this.setupHighContrastMode(),this.addSkipLinks(),console.log("â™¿ Accessibility Manager initialized"),console.log("ðŸŽ¯ Screen Reader detected:",this.screenReaderActive)}detectScreenReader(){return!!(navigator.userAgent.includes("NVDA")||navigator.userAgent.includes("JAWS")||navigator.userAgent.includes("VoiceOver")||window.speechSynthesis||document.querySelector("[aria-live]"))}setupScreenReaderSupport(){this.createLiveRegion(),this.addAriaLabels(),this.setupLandmarkRegions()}createLiveRegion(){const e=document.createElement("div");e.id="live-announcements",e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.style.cssText="\n            position: absolute !important;\n            left: -10000px !important;\n            width: 1px !important;\n            height: 1px !important;\n            overflow: hidden !important;\n        ",document.body.appendChild(e)}announce(e,t="polite"){const n=document.getElementById("live-announcements");n&&(n.setAttribute("aria-live",t),n.textContent=e,setTimeout(()=>{n.textContent=""},1e3)),console.log(`ðŸ“¢ Announced: ${e}`)}addAriaLabels(){document.querySelectorAll("button:not([aria-label]):not([aria-labelledby])").forEach(e=>{const t=e.querySelector('[class*="icon"], .emoji');if(!e.textContent.trim()&&t){const n=t.className;let o="Button";n.includes("close")?o="Close":n.includes("menu")?o="Menu":n.includes("play")?o="Play":n.includes("pause")?o="Pause":n.includes("next")?o="Next":n.includes("previous")&&(o="Previous"),e.setAttribute("aria-label",o)}}),document.querySelectorAll("input:not([aria-label]):not([aria-labelledby])").forEach(e=>{const t=e.placeholder,n=e.type;if(t)e.setAttribute("aria-label",t);else{const t=n.charAt(0).toUpperCase()+n.slice(1)+" input";e.setAttribute("aria-label",t)}})}setupLandmarkRegions(){const e=document.querySelector("main")||document.body;e.getAttribute("role")||e.setAttribute("role","main"),document.querySelectorAll("nav").forEach(e=>{e.getAttribute("aria-label")||e.setAttribute("aria-label","Site navigation")}),document.querySelectorAll(".section-container, .content-section").forEach(e=>{e.setAttribute("role","region");const t=e.querySelector("h1, h2, h3");if(t){const n=t.id||`section-${Math.random().toString(36).substr(2,9)}`;t.id=n,e.setAttribute("aria-labelledby",n)}})}setupKeyboardNavigation(){document.addEventListener("keydown",this.handleKeyDown.bind(this)),this.enhanceKeyboardAccess(),this.setupTabIndexManagement()}handleKeyDown(e){switch(e.key){case"Escape":this.handleEscape(e);break;case"Tab":this.handleTab(e);break;case"Enter":case" ":this.handleActivation(e);break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":this.handleArrowKeys(e)}}handleEscape(e){const t=document.querySelector(".modal.active, .dropdown.open");t&&(this.closeModal(t),e.preventDefault()),document.querySelector("#section-container.active")&&window.returnToDashboard&&window.returnToDashboard()}handleTab(e){const t=document.querySelector(".modal.active");t&&this.trapFocus(t,e)}handleActivation(e){const t=e.target;(t.classList.contains("card")||t.classList.contains("nav-card")||"button"===t.getAttribute("role"))&&t.onclick&&(t.onclick(e),e.preventDefault())}handleArrowKeys(e){const t=e.target.closest(".nav-grid, .cards-grid, .videos-grid");t&&this.navigateGrid(t,e)}enhanceKeyboardAccess(){document.querySelectorAll(".nav-card, .card, .video-card").forEach(e=>{e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),e.getAttribute("role")||e.setAttribute("role","button")}),document.addEventListener("focusin",e=>{e.target.matches(".nav-card, .card, .video-card")&&e.target.classList.add("keyboard-focused")}),document.addEventListener("focusout",e=>{e.target.classList.remove("keyboard-focused")})}setupTabIndexManagement(){document.querySelectorAll('[tabindex="0"]').forEach((e,t)=>{e.setAttribute("data-tab-order",t)})}navigateGrid(e,t){const n=Array.from(e.querySelectorAll('[tabindex="0"]')),o=n.indexOf(t.target),i=this.getGridColumns(e);let r=o;switch(t.key){case"ArrowRight":r=Math.min(o+1,n.length-1);break;case"ArrowLeft":r=Math.max(o-1,0);break;case"ArrowDown":r=Math.min(o+i,n.length-1);break;case"ArrowUp":r=Math.max(o-i,0)}r!==o&&(n[r].focus(),t.preventDefault())}getGridColumns(e){return window.getComputedStyle(e).gridTemplateColumns.split(" ").length||3}setupFocusManagement(){this.createFocusIndicators(),this.setupFocusTrap()}createFocusIndicators(){const e=document.createElement("style");e.textContent="\n            .keyboard-focused {\n                outline: 3px solid #8B5CF6 !important;\n                outline-offset: 2px !important;\n                border-radius: 8px !important;\n            }\n            \n            .focus-visible {\n                outline: 2px solid #D4AF37 !important;\n                outline-offset: 2px !important;\n            }\n            \n            .skip-link {\n                position: absolute;\n                top: -40px;\n                left: 6px;\n                background: #000;\n                color: #fff;\n                padding: 8px;\n                text-decoration: none;\n                border-radius: 4px;\n                z-index: 10000;\n                transition: top 0.3s;\n            }\n            \n            .skip-link:focus {\n                top: 6px;\n            }\n        ",document.head.appendChild(e)}setupFocusTrap(){this.focusableElements=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(",")}trapFocus(e,t){const n=e.querySelectorAll(this.focusableElements),o=n[0],i=n[n.length-1];t.shiftKey&&document.activeElement===o?(i.focus(),t.preventDefault()):t.shiftKey||document.activeElement!==i||(o.focus(),t.preventDefault())}addSkipLinks(){const e=document.createElement("a");e.href="#main-content",e.className="skip-link",e.textContent="Skip to main content",document.body.insertBefore(e,document.body.firstChild);const t=document.querySelector("main, #dashboard, .section-container");t&&!t.id&&(t.id="main-content")}setupHighContrastMode(){window.matchMedia("(prefers-contrast: high)").matches&&this.enableHighContrastMode(),this.addHighContrastToggle()}enableHighContrastMode(){document.documentElement.classList.add("high-contrast"),this.highContrastMode=!0;const e=document.createElement("style");e.id="high-contrast-styles",e.textContent="\n            .high-contrast {\n                --accent-gold: #FFD700 !important;\n                --accent-purple: #9370DB !important;\n                --text-primary: #FFFFFF !important;\n                --text-secondary: #E0E0E0 !important;\n                --glass-bg: rgba(0, 0, 0, 0.9) !important;\n                --glass-border: #FFFFFF !important;\n            }\n            \n            .high-contrast * {\n                border-color: #FFFFFF !important;\n            }\n            \n            .high-contrast .nav-card:hover,\n            .high-contrast .card:hover {\n                background: #000000 !important;\n                border-color: #FFD700 !important;\n            }\n        ",document.head.appendChild(e),this.announce("High contrast mode enabled")}addHighContrastToggle(){const e=document.createElement("button");e.innerHTML="ðŸŽ¨",e.setAttribute("aria-label","Toggle high contrast mode"),e.style.cssText="\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: rgba(0, 0, 0, 0.8);\n            border: 2px solid #FFFFFF;\n            color: white;\n            width: 50px;\n            height: 50px;\n            border-radius: 50%;\n            font-size: 1.2rem;\n            cursor: pointer;\n            z-index: 9999;\n            transition: all 0.3s;\n        ",e.addEventListener("click",()=>{this.highContrastMode?this.disableHighContrastMode():this.enableHighContrastMode()}),document.body.appendChild(e)}disableHighContrastMode(){document.documentElement.classList.remove("high-contrast"),this.highContrastMode=!1;const e=document.getElementById("high-contrast-styles");e&&e.remove(),this.announce("High contrast mode disabled")}closeModal(e){e.classList.remove("active");const t=document.querySelector("[data-modal-trigger]");t&&t.focus(),this.announce("Modal closed")}validateAccessibility(){const e=[];document.querySelectorAll("img:not([alt])").forEach(t=>{e.push(`Image missing alt text: ${t.src}`)}),document.querySelectorAll("input:not([aria-label]):not([aria-labelledby])").forEach(t=>{document.querySelector(`label[for="${t.id}"]`)||e.push(`Input missing label: ${t.type}`)});0===document.querySelectorAll("h1, h2, h3, h4, h5, h6").length&&e.push("No heading structure found");const t=this.checkColorContrast();return e.push(...t),e.length>0?console.warn("Accessibility issues found:",e):console.log("âœ… Accessibility validation passed"),e}checkColorContrast(){return[]}getAccessibilityReport(){return{screenReaderActive:this.screenReaderActive,highContrastMode:this.highContrastMode,keyboardNavigation:this.keyboardNavigation,issues:this.validateAccessibility(),features:["Screen reader support","Keyboard navigation","Focus management","High contrast mode","Live announcements","Skip links","ARIA labels"]}}}class UXEnhancementManager{constructor(){this.notifications=[],this.loadingStates=new Map,this.userPreferences=this.loadUserPreferences(),this.init()}init(){this.setupNotificationSystem(),this.setupLoadingStates(),this.setupUserFeedback(),this.setupHelpSystem(),this.setupErrorHandling(),console.log("âœ¨ UX Enhancement Manager initialized")}setupNotificationSystem(){const e=document.createElement("div");e.id="notification-container",e.style.cssText="\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            z-index: 10000;\n            pointer-events: none;\n        ",document.body.appendChild(e)}showNotification(e,t="info",n=4e3){const o=document.createElement("div");o.className=`notification notification-${t}`,o.style.cssText=`\n            background: ${this.getNotificationColor(t)};\n            color: white;\n            padding: 1rem 1.5rem;\n            border-radius: 8px;\n            margin-bottom: 0.5rem;\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n            transform: translateX(100%);\n            transition: transform 0.3s ease;\n            pointer-events: auto;\n            cursor: pointer;\n            max-width: 300px;\n        `,o.textContent=e;return document.getElementById("notification-container").appendChild(o),setTimeout(()=>{o.style.transform="translateX(0)"},10),setTimeout(()=>{this.removeNotification(o)},n),o.addEventListener("click",()=>{this.removeNotification(o)}),o}getNotificationColor(e){const t={success:"#10B981",error:"#EF4444",warning:"#F59E0B",info:"#3B82F6",spiritual:"#8B5CF6"};return t[e]||t.info}removeNotification(e){e.style.transform="translateX(100%)",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300)}setupLoadingStates(){this.createLoadingOverlay()}createLoadingOverlay(){const e=document.createElement("div");e.id="global-loading-overlay",e.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(0, 0, 0, 0.8);\n            backdrop-filter: blur(10px);\n            display: none;\n            align-items: center;\n            justify-content: center;\n            z-index: 9999;\n            flex-direction: column;\n        ",e.innerHTML='\n            <div class="loading-spinner" style="\n                width: 60px;\n                height: 60px;\n                border: 4px solid rgba(139, 92, 246, 0.3);\n                border-left-color: #8B5CF6;\n                border-radius: 50%;\n                animation: spin 1s linear infinite;\n                margin-bottom: 1rem;\n            "></div>\n            <div style="color: white; font-size: 1.1rem;">Loading divine content...</div>\n        ',document.body.appendChild(e)}showLoading(e="Loading..."){const t=document.getElementById("global-loading-overlay");t.querySelector("div:last-child").textContent=e,t.style.display="flex"}hideLoading(){document.getElementById("global-loading-overlay").style.display="none"}setupUserFeedback(){this.setupProgressIndicators(),this.setupConfirmationDialogs()}setupProgressIndicators(){window.addEventListener("progressStart",e=>{this.showProgress(e.detail)}),window.addEventListener("progressUpdate",e=>{this.updateProgress(e.detail)}),window.addEventListener("progressComplete",()=>{this.hideProgress()})}showProgress(e={}){const{message:t="Processing...",percentage:n=0}=e;let o=document.getElementById("progress-indicator");o||(o=this.createProgressBar()),o.style.display="block",o.querySelector(".progress-message").textContent=t,o.querySelector(".progress-fill").style.width=`${n}%`}createProgressBar(){const e=document.createElement("div");return e.id="progress-indicator",e.style.cssText="\n            position: fixed;\n            bottom: 20px;\n            left: 50%;\n            transform: translateX(-50%);\n            background: rgba(0, 0, 0, 0.9);\n            color: white;\n            padding: 1rem 2rem;\n            border-radius: 12px;\n            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n            z-index: 10000;\n            display: none;\n            min-width: 300px;\n        ",e.innerHTML='\n            <div class="progress-message" style="margin-bottom: 0.5rem; text-align: center;">Processing...</div>\n            <div style="background: rgba(255, 255, 255, 0.2); border-radius: 10px; height: 8px; overflow: hidden;">\n                <div class="progress-fill" style="\n                    background: linear-gradient(90deg, #8B5CF6, #D4AF37);\n                    height: 100%;\n                    width: 0%;\n                    transition: width 0.3s ease;\n                    border-radius: 10px;\n                "></div>\n            </div>\n        ',document.body.appendChild(e),e}updateProgress(e={}){const{percentage:t=0,message:n}=e,o=document.getElementById("progress-indicator");o&&(o.querySelector(".progress-fill").style.width=`${t}%`,n&&(o.querySelector(".progress-message").textContent=n))}hideProgress(){const e=document.getElementById("progress-indicator");e&&(e.style.display="none")}setupConfirmationDialogs(){window.confirmAction=(e,t,n)=>this.showConfirmDialog(e,t,n)}showConfirmDialog(e,t,n){const o=document.createElement("div");o.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(0, 0, 0, 0.8);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            z-index: 10001;\n        ",o.innerHTML=`\n            <div style="\n                background: linear-gradient(135deg, #1a1a2e, #16213e);\n                color: white;\n                padding: 2rem;\n                border-radius: 15px;\n                max-width: 400px;\n                text-align: center;\n                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n            ">\n                <div style="margin-bottom: 1.5rem; font-size: 1.1rem; line-height: 1.5;">${e}</div>\n                <div style="display: flex; gap: 1rem; justify-content: center;">\n                    <button class="confirm-btn" style="\n                        background: linear-gradient(135deg, #10B981, #059669);\n                        border: none;\n                        padding: 0.75rem 1.5rem;\n                        border-radius: 8px;\n                        color: white;\n                        font-weight: 600;\n                        cursor: pointer;\n                        transition: transform 0.2s;\n                    ">Confirm</button>\n                    <button class="cancel-btn" style="\n                        background: rgba(255, 255, 255, 0.1);\n                        border: 1px solid rgba(255, 255, 255, 0.3);\n                        padding: 0.75rem 1.5rem;\n                        border-radius: 8px;\n                        color: white;\n                        font-weight: 600;\n                        cursor: pointer;\n                        transition: transform 0.2s;\n                    ">Cancel</button>\n                </div>\n            </div>\n        `;const i=o.querySelector(".confirm-btn"),r=o.querySelector(".cancel-btn");i.addEventListener("click",()=>{document.body.removeChild(o),t&&t()}),r.addEventListener("click",()=>{document.body.removeChild(o),n&&n()}),i.addEventListener("mouseenter",()=>{i.style.transform="translateY(-2px)"}),r.addEventListener("mouseenter",()=>{r.style.transform="translateY(-2px)"}),document.body.appendChild(o),i.focus()}setupHelpSystem(){this.addHelpTooltips(),this.setupContextualHelp()}addHelpTooltips(){document.querySelectorAll("[data-tooltip]").forEach(e=>{this.addTooltip(e,e.dataset.tooltip)})}addTooltip(e,t){e.addEventListener("mouseenter",()=>{this.showTooltip(e,t)}),e.addEventListener("mouseleave",()=>{this.hideTooltip()})}showTooltip(e,t){const n=document.createElement("div");n.id="active-tooltip",n.style.cssText="\n            position: absolute;\n            background: rgba(0, 0, 0, 0.9);\n            color: white;\n            padding: 0.5rem 0.75rem;\n            border-radius: 6px;\n            font-size: 0.9rem;\n            z-index: 10002;\n            pointer-events: none;\n            white-space: nowrap;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n        ",n.textContent=t,document.body.appendChild(n);const o=e.getBoundingClientRect();n.style.left=o.left+o.width/2-n.offsetWidth/2+"px",n.style.top=o.top-n.offsetHeight-8+"px"}hideTooltip(){const e=document.getElementById("active-tooltip");e&&e.remove()}setupContextualHelp(){window.addEventListener("sectionChange",e=>{this.updateContextualHelp(e.detail.section)})}updateContextualHelp(e){const t={"oracle-cards":"Draw cards for divine guidance and spiritual insights","sacred-books":"Read and study sacred texts with interactive features","videos-media":"Watch curated spiritual content and join discussions","sacred-geometry":"Explore mystical patterns and sacred mathematics"}[e];t&&this.showNotification(t,"spiritual",6e3)}setupErrorHandling(){window.addEventListener("error",this.handleGlobalError.bind(this)),window.addEventListener("unhandledrejection",this.handlePromiseError.bind(this))}handleGlobalError(e){console.error("Global error:",e.error),this.showNotification("An unexpected error occurred. Please try again.","error")}handlePromiseError(e){console.error("Promise rejection:",e.reason),this.showNotification("A background operation failed. Please refresh if issues persist.","warning")}loadUserPreferences(){const e={animations:!0,notifications:!0,sounds:!1,theme:"auto"};try{const t=localStorage.getItem("divine-temple-preferences");return t?{...e,...JSON.parse(t)}:e}catch(t){return e}}saveUserPreferences(){localStorage.setItem("divine-temple-preferences",JSON.stringify(this.userPreferences))}updatePreference(e,t){this.userPreferences[e]=t,this.saveUserPreferences(),this.applyPreferences()}applyPreferences(){this.userPreferences.animations||document.documentElement.style.setProperty("--animation-duration","0.01s"),this.userPreferences.notifications||this.notifications.forEach(e=>{this.removeNotification(e)})}getEnhancementReport(){return{userPreferences:this.userPreferences,activeNotifications:this.notifications.length,loadingStates:this.loadingStates.size,features:["Toast notifications","Loading indicators","Progress tracking","Confirmation dialogs","Help tooltips","Error handling","User preferences"]}}}window.AccessibilityManager=AccessibilityManager,window.UXEnhancementManager=UXEnhancementManager,window.accessibilityManager||(window.accessibilityManager=new AccessibilityManager),window.uxEnhancementManager||(window.uxEnhancementManager=new UXEnhancementManager),console.log("âœ¨ Accessibility & UX Enhancement Suite loaded");