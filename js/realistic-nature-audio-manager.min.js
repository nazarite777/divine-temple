class RealisticNatureAudioManager{constructor(){this.sounds={},this.activeAudio={},this.volumes={},this.masterVolume=.7,this.fadeTime=2e3,this.preloadEnabled=!0,this.initialized=!1,this.audioFiles={rain:"audio/sounds/rain-gentle-loop.mp3",thunder:"audio/sounds/thunder-distant.mp3",wind:"audio/sounds/wind-breeze-loop.mp3",crickets:"audio/sounds/crickets-night-loop.mp3",owl:"audio/sounds/owl-forest.mp3",frogs:"audio/sounds/frogs-pond-loop.mp3",cicadas:"audio/sounds/cicadas-summer-loop.mp3",birds:"audio/sounds/birds-forest-morning.mp3",wolf:"audio/sounds/wolf-howl-distant.mp3",ocean:"audio/sounds/ocean-waves-loop.mp3",stream:"audio/sounds/stream-flowing-loop.mp3",fire:"audio/sounds/fire-crackling-loop.mp3",leaves:"audio/sounds/leaves-rustling-loop.mp3",chimes:null,bowl:null,brown:null},this.soundConfig={rain:{loop:!0,defaultVolume:.5,fadeIn:!0},thunder:{loop:!1,defaultVolume:.6,fadeIn:!1,interval:15e3},wind:{loop:!0,defaultVolume:.4,fadeIn:!0},crickets:{loop:!0,defaultVolume:.6,fadeIn:!0},owl:{loop:!1,defaultVolume:.5,fadeIn:!1,interval:2e4},frogs:{loop:!0,defaultVolume:.5,fadeIn:!0},cicadas:{loop:!0,defaultVolume:.5,fadeIn:!0},birds:{loop:!0,defaultVolume:.5,fadeIn:!0},wolf:{loop:!1,defaultVolume:.6,fadeIn:!1,interval:45e3},ocean:{loop:!0,defaultVolume:.5,fadeIn:!0},stream:{loop:!0,defaultVolume:.5,fadeIn:!0},fire:{loop:!0,defaultVolume:.5,fadeIn:!0},leaves:{loop:!0,defaultVolume:.4,fadeIn:!0},chimes:{loop:!1,synthesized:!0},bowl:{loop:!1,synthesized:!0},brown:{loop:!0,synthesized:!0}},this.intervals={},console.log("ðŸŒ Realistic Nature Audio Manager initialized")}async init(){if(!this.initialized){if(console.log("ðŸŽµ Initializing audio system..."),this.preloadEnabled){const o=["rain","wind","crickets","birds","fire","ocean"];await this.preloadSounds(o)}this.initialized=!0,console.log("âœ… Audio system ready")}}async preloadSounds(o){console.log("ðŸ“¥ Preloading sounds:",o.join(", "));const e=o.map(o=>new Promise(e=>{const s=this.audioFiles[o];if(!s)return void e();const i=new Audio;i.preload="auto",i.src=s,i.addEventListener("canplaythrough",()=>{this.sounds[o]=i,console.log(`âœ“ ${o} loaded`),e()},{once:!0}),i.addEventListener("error",s=>{console.warn(`âš ï¸ Failed to load ${o}:`,s),e()}),i.load()}));await Promise.all(e),console.log("âœ… Preloading complete")}loadSound(o){return new Promise((e,s)=>{const i=this.audioFiles[o];if(!i)return void s(new Error(`No audio file configured for ${o}`));if(this.sounds[o])return void e(this.sounds[o]);const t=new Audio(i);t.preload="auto",t.addEventListener("canplaythrough",()=>{this.sounds[o]=t,e(t)},{once:!0}),t.addEventListener("error",e=>{s(new Error(`Failed to load ${o}: ${e.message}`))}),t.load()})}async playSound(o,e={}){try{const e=this.soundConfig[o];if(e&&e.synthesized)return console.log(`ðŸŽ¹ ${o} uses synthesis (skipping real audio)`),null;if(this.activeAudio[o])return console.log(`â¸ï¸ ${o} already playing`),this.activeAudio[o];console.log(`â–¶ï¸ Starting ${o}...`),this.sounds[o]||await this.loadSound(o);const s=this.sounds[o].cloneNode();s.loop=e?.loop||!1,s.volume=0,this.activeAudio[o]=s,this.volumes[o]=e?.defaultVolume||.5;const i=s.play();return void 0!==i&&i.catch(e=>{console.error(`Play failed for ${o}:`,e),delete this.activeAudio[o]}),e?.fadeIn?this.fadeIn(s,this.volumes[o]*this.masterVolume):s.volume=this.volumes[o]*this.masterVolume,!e?.loop&&e?.interval&&this.scheduleInterval(o,e.interval),s.addEventListener("ended",()=>{s.loop||delete this.activeAudio[o]}),s}catch(e){return console.error(`Failed to play ${o}:`,e),null}}scheduleInterval(o,e){this.intervals[o]&&clearInterval(this.intervals[o]),this.intervals[o]=setInterval(()=>{const s=Math.random()*e*.6-.3*e;setTimeout(()=>{this.activeAudio[o]&&this.playSound(o)},s)},e)}async stopSound(o){const e=this.activeAudio[o];e?(console.log(`â¹ï¸ Stopping ${o}...`),this.intervals[o]&&(clearInterval(this.intervals[o]),delete this.intervals[o]),await this.fadeOut(e),e.pause(),e.currentTime=0,delete this.activeAudio[o]):console.log(`â¹ï¸ ${o} not playing`)}fadeIn(o,e){const s=this.fadeTime/50,i=e/50;let t=0;const n=setInterval(()=>{t++,o.volume=Math.min(i*t,e),t>=50&&clearInterval(n)},s)}fadeOut(o){return new Promise(e=>{const s=this.fadeTime/50,i=o.volume/50;let t=0;const n=setInterval(()=>{t++,o.volume=Math.max(o.volume-i,0),(t>=50||0===o.volume)&&(clearInterval(n),e())},s)})}setVolume(o,e){e=Math.max(0,Math.min(1,e)),this.volumes[o]=e;const s=this.activeAudio[o];s&&(s.volume=e*this.masterVolume),console.log(`ðŸ”Š ${o} volume: ${Math.round(100*e)}%`)}setMasterVolume(o){o=Math.max(0,Math.min(1,o)),this.masterVolume=o,Object.keys(this.activeAudio).forEach(o=>{const e=this.activeAudio[o];e&&(e.volume=this.volumes[o]*this.masterVolume)}),console.log(`ðŸ”Š Master volume: ${Math.round(100*o)}%`)}async toggleSound(o,e){e?await this.playSound(o):await this.stopSound(o)}isPlaying(o){return!!this.activeAudio[o]}async stopAll(){console.log("â¹ï¸ Stopping all sounds...");const o=Object.keys(this.activeAudio).map(o=>this.stopSound(o));await Promise.all(o)}getActiveSounds(){return Object.keys(this.activeAudio)}cleanup(){this.stopAll(),Object.values(this.sounds).forEach(o=>{o.src=""}),this.sounds={},this.activeAudio={},this.initialized=!1,console.log("ðŸ§¹ Audio manager cleaned up")}debug(){console.log("ðŸ”§ Audio Manager Debug:"),console.log("- Initialized:",this.initialized),console.log("- Master Volume:",Math.round(100*this.masterVolume)+"%"),console.log("- Loaded sounds:",Object.keys(this.sounds)),console.log("- Active sounds:",Object.keys(this.activeAudio)),console.log("- Individual volumes:",this.volumes)}}if("undefined"!=typeof window){window.realisticAudio=new RealisticNatureAudioManager;const o=()=>{window.realisticAudio.init(),document.removeEventListener("click",o),document.removeEventListener("touchstart",o)};document.addEventListener("click",o,{once:!0}),document.addEventListener("touchstart",o,{once:!0})}