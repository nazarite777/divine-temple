class TriviaAudioSystem{constructor(){this.audioContext=null,this.soundEnabled=!0,this.musicEnabled=!0,this.masterVolume=.7,this.sounds={questionReveal:null,correctAnswer:null,wrongAnswer:null,timerWarning:null,timerCritical:null,victory:null,perfectScore:null,streak:null,click:null,hover:null,achievement:null},this.backgroundMusic={oscillators:[],gainNodes:[],isPlaying:!1},this.init()}async init(){console.log("ðŸŽµ Initializing Trivia Audio System...");try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),console.log("âœ… Audio context created"),this.createSoundEffects(),this.loadSoundPreferences(),console.log("ðŸŽµ Trivia Audio System ready!")}catch(t){console.error("âŒ Audio system initialization failed:",t)}}createSoundEffects(){console.log("ðŸ”Š Creating realistic trivia sound effects..."),this.sounds.questionReveal=()=>{[523,659,784].forEach((t,e)=>{setTimeout(()=>{this.playBellTone(t,.4,.25)},120*e)})},this.sounds.correctAnswer=()=>{[523,659,784].forEach(t=>{this.playSingingBowl(t,.8,.35)}),setTimeout(()=>{[1319,1568,1865,2093].forEach((t,e)=>{setTimeout(()=>{this.playBellTone(t,.3,.15)},60*e)})},200)},this.sounds.wrongAnswer=()=>{this.playWoodenBlock(.25)},this.sounds.timerWarning=()=>{this.playTingshaClick(.18)},this.sounds.timerCritical=()=>{this.playTingshaClick(.22),setTimeout(()=>this.playTingshaClick(.22),180)},this.sounds.victory=()=>{[[523,659,784],[587,740,880],[659,831,988],[523,659,784,1047]].forEach((t,e)=>{setTimeout(()=>{t.forEach(t=>{this.playBellTone(t,1.2,.3)})},400*e)})},this.sounds.perfectScore=()=>{this.sounds.victory(),setTimeout(()=>{[1047,1319,1568,1865,2093,2349].forEach((t,e)=>{setTimeout(()=>{this.playTone(t,.3,"sine",.2)},100*e)})},800)},this.sounds.streak=()=>{this.playSequence([659,784,988,1175],.2,"sine",.3,120)},this.sounds.click=()=>{this.playTone(1200,.05,"sine",.1)},this.sounds.hover=()=>{this.playTone(800,.03,"sine",.05)},this.sounds.achievement=()=>{[523,659,784,1047,1319].forEach((t,e)=>{setTimeout(()=>{this.playTone(t,.4,"sine",.3)},150*e)})},console.log("âœ… All trivia sound effects created")}playBellTone(t,e=.6,i=.3){if(!this.soundEnabled||!this.audioContext)return;const o=this.audioContext.currentTime,n=this.audioContext.createOscillator();n.type="sine",n.frequency.setValueAtTime(t,o);const s=this.audioContext.createOscillator();s.type="sine",s.frequency.setValueAtTime(2.76*t,o);const a=this.audioContext.createOscillator();a.type="sine",a.frequency.setValueAtTime(5.4*t,o);const u=this.audioContext.createGain(),c=this.audioContext.createGain(),r=this.audioContext.createGain();u.gain.setValueAtTime(0,o),u.gain.linearRampToValueAtTime(i*this.masterVolume,o+.01),u.gain.exponentialRampToValueAtTime(.001,o+e),c.gain.setValueAtTime(0,o),c.gain.linearRampToValueAtTime(.6*i*this.masterVolume,o+.01),c.gain.exponentialRampToValueAtTime(.001,o+.8*e),r.gain.setValueAtTime(0,o),r.gain.linearRampToValueAtTime(.3*i*this.masterVolume,o+.005),r.gain.exponentialRampToValueAtTime(.001,o+.5*e);const l=this.audioContext.createDelay();l.delayTime.setValueAtTime(.03,o);const d=this.audioContext.createGain();d.gain.setValueAtTime(.15,o),n.connect(u),s.connect(c),a.connect(r),u.connect(this.audioContext.destination),c.connect(this.audioContext.destination),r.connect(this.audioContext.destination),u.connect(l),l.connect(d),d.connect(this.audioContext.destination),n.start(o),s.start(o),a.start(o),n.stop(o+e+.1),s.stop(o+e+.1),a.stop(o+e+.1)}playSingingBowl(t,e=1.5,i=.3){if(!this.soundEnabled||!this.audioContext)return;const o=this.audioContext.currentTime,n=this.audioContext.createOscillator();n.type="sine",n.frequency.setValueAtTime(t,o);const s=this.audioContext.createOscillator();s.frequency.setValueAtTime(4,o);const a=this.audioContext.createGain();a.gain.setValueAtTime(3,o),s.connect(a),a.connect(n.frequency);const u=this.audioContext.createGain();u.gain.setValueAtTime(0,o),u.gain.linearRampToValueAtTime(i*this.masterVolume,o+.1),u.gain.exponentialRampToValueAtTime(.7*i*this.masterVolume,o+.5),u.gain.exponentialRampToValueAtTime(.001,o+e);const c=this.audioContext.createBiquadFilter();c.type="lowpass",c.frequency.setValueAtTime(3*t,o),n.connect(c),c.connect(u),u.connect(this.audioContext.destination),n.start(o),s.start(o),n.stop(o+e),s.stop(o+e)}playWoodenBlock(t=.3){if(!this.soundEnabled||!this.audioContext)return;const e=this.audioContext.currentTime,i=this.audioContext.createOscillator();i.type="sine",i.frequency.setValueAtTime(440,e);const o=this.audioContext.createOscillator();o.type="sine",o.frequency.setValueAtTime(880,e);const n=this.audioContext.createGain(),s=this.audioContext.createGain();n.gain.setValueAtTime(0,e),n.gain.linearRampToValueAtTime(.2*t*this.masterVolume,e+.005),n.gain.exponentialRampToValueAtTime(.001,e+.2),s.gain.setValueAtTime(0,e),s.gain.linearRampToValueAtTime(.1*t*this.masterVolume,e+.005),s.gain.exponentialRampToValueAtTime(.001,e+.15);const a=this.audioContext.createBiquadFilter();a.type="lowpass",a.frequency.setValueAtTime(1200,e),a.Q.setValueAtTime(.5,e),i.connect(a),o.connect(a),a.connect(n),a.connect(s),n.connect(this.audioContext.destination),s.connect(this.audioContext.destination),i.start(e),o.start(e),i.stop(e+.25),o.stop(e+.2)}playTingshaClick(t=.2){if(!this.soundEnabled||!this.audioContext)return;const e=this.audioContext.currentTime,i=this.audioContext.createOscillator(),o=this.audioContext.createOscillator();i.frequency.setValueAtTime(2500,e),o.frequency.setValueAtTime(2637,e),i.type="sine",o.type="sine";const n=this.audioContext.createGain(),s=this.audioContext.createGain();n.gain.setValueAtTime(0,e),n.gain.linearRampToValueAtTime(t*this.masterVolume,e+.005),n.gain.exponentialRampToValueAtTime(.001,e+.3),s.gain.setValueAtTime(0,e),s.gain.linearRampToValueAtTime(.8*t*this.masterVolume,e+.005),s.gain.exponentialRampToValueAtTime(.001,e+.25),i.connect(n),o.connect(s),n.connect(this.audioContext.destination),s.connect(this.audioContext.destination),i.start(e),o.start(e),i.stop(e+.35),o.stop(e+.3)}playTone(t,e,i="sine",o=.3){if(this.soundEnabled&&this.audioContext)try{const n=this.audioContext.createOscillator(),s=this.audioContext.createGain();n.connect(s),s.connect(this.audioContext.destination),n.frequency.setValueAtTime(t,this.audioContext.currentTime),n.type=i;const a=this.audioContext.currentTime;s.gain.setValueAtTime(0,a),s.gain.linearRampToValueAtTime(o*this.masterVolume,a+.01),s.gain.exponentialRampToValueAtTime(.001,a+e),n.start(a),n.stop(a+e)}catch(t){console.error("Error playing tone:",t)}}playChord(t,e,i="sine",o=.4){this.soundEnabled&&this.audioContext&&t.forEach(n=>{this.playTone(n,e,i,o/t.length)})}playSequence(t,e,i="sine",o=.3,n=100){this.soundEnabled&&this.audioContext&&t.forEach((t,s)=>{setTimeout(()=>{this.playTone(t,e,i,o)},s*n)})}startBackgroundMusic(){if(!this.musicEnabled||!this.audioContext||this.backgroundMusic.isPlaying)return;console.log("ðŸŽµ Starting trivia background music...");[174,285,396,417,528,639,741,852].forEach((t,e)=>{setTimeout(()=>{try{const e=this.audioContext.createOscillator(),i=this.audioContext.createGain(),o=this.audioContext.createBiquadFilter();e.connect(o),o.connect(i),i.connect(this.audioContext.destination),e.frequency.setValueAtTime(t,this.audioContext.currentTime),e.type="sine",o.type="lowpass",o.frequency.setValueAtTime(1.5*t,this.audioContext.currentTime),i.gain.setValueAtTime(0,this.audioContext.currentTime),i.gain.linearRampToValueAtTime(.015*this.masterVolume,this.audioContext.currentTime+3),e.start(),this.backgroundMusic.oscillators.push(e),this.backgroundMusic.gainNodes.push(i)}catch(t){console.error("Error creating background music:",t)}},1e3*e)}),this.backgroundMusic.isPlaying=!0}stopBackgroundMusic(){this.backgroundMusic.isPlaying&&(console.log("ðŸŽµ Stopping trivia background music..."),this.backgroundMusic.gainNodes.forEach(t=>{try{t.gain.linearRampToValueAtTime(0,this.audioContext.currentTime+1)}catch(t){}}),this.backgroundMusic.oscillators.forEach(t=>{try{t.stop(this.audioContext.currentTime+1)}catch(t){}}),this.backgroundMusic.oscillators=[],this.backgroundMusic.gainNodes=[],this.backgroundMusic.isPlaying=!1)}toggleSound(){return this.soundEnabled=!this.soundEnabled,this.saveSoundPreferences(),this.soundEnabled&&setTimeout(()=>this.sounds.click(),100),console.log("ðŸ”Š Sound effects "+(this.soundEnabled?"enabled":"disabled")),this.soundEnabled}toggleMusic(){return this.musicEnabled=!this.musicEnabled,this.saveSoundPreferences(),this.musicEnabled?this.startBackgroundMusic():this.stopBackgroundMusic(),console.log("ðŸŽµ Background music "+(this.musicEnabled?"enabled":"disabled")),this.musicEnabled}setMasterVolume(t){this.masterVolume=Math.max(0,Math.min(1,t)),this.saveSoundPreferences(),console.log(`ðŸ”Š Master volume set to ${Math.round(100*this.masterVolume)}%`)}loadSoundPreferences(){try{const t=localStorage.getItem("trivia-audio-settings");if(t){const e=JSON.parse(t);this.soundEnabled=!1!==e.soundEnabled,this.musicEnabled=!1!==e.musicEnabled,this.masterVolume=e.masterVolume||.7,console.log("âœ… Audio preferences loaded")}}catch(t){console.error("Error loading audio preferences:",t)}}saveSoundPreferences(){try{const t={soundEnabled:this.soundEnabled,musicEnabled:this.musicEnabled,masterVolume:this.masterVolume};localStorage.setItem("trivia-audio-settings",JSON.stringify(t))}catch(t){console.error("Error saving audio preferences:",t)}}async resumeAudioContext(){if(this.audioContext&&"suspended"===this.audioContext.state)try{await this.audioContext.resume(),console.log("âœ… Audio context resumed")}catch(t){console.error("Error resuming audio context:",t)}}playSound(t){this.sounds[t]&&"function"==typeof this.sounds[t]?(this.resumeAudioContext(),this.sounds[t]()):console.warn(`Sound "${t}" not found`)}destroy(){if(console.log("ðŸŽµ Cleaning up Trivia Audio System..."),this.stopBackgroundMusic(),this.audioContext)try{this.audioContext.close()}catch(t){console.error("Error closing audio context:",t)}}}window.TriviaAudioSystem=TriviaAudioSystem;