class AchievementSystem{constructor(){this.currentUser=null,this.achievementData=null,this.isInitialized=!1,this.achievements={trivia_first_steps:{id:"trivia_first_steps",name:"üéØ First Steps",description:"Complete your first daily trivia",category:"Trivia",xpReward:50,condition:e=>e.triviaCompleted>=1},trivia_perfect_scholar:{id:"trivia_perfect_scholar",name:"üèÜ Perfect Scholar",description:"Get your first perfect score (5/5)",category:"Trivia",xpReward:100,condition:e=>e.triviaPerfectScores>=1},trivia_dedicated_seeker:{id:"trivia_dedicated_seeker",name:"üî• Dedicated Seeker",description:"Maintain a 7-day trivia streak",category:"Trivia",xpReward:200,condition:e=>e.triviaStreak>=7},trivia_master:{id:"trivia_master",name:"‚≠ê Trivia Master",description:"Maintain a 30-day trivia streak",category:"Trivia",xpReward:500,condition:e=>e.triviaStreak>=30},trivia_legend:{id:"trivia_legend",name:"üëë Trivia Legend",description:"Achieve 10 perfect scores",category:"Trivia",xpReward:1e3,condition:e=>e.triviaPerfectScores>=10},premium_trivia_first:{id:"premium_trivia_first",name:"üåü Premium Seeker",description:"Complete your first premium trivia question",category:"Premium Trivia",xpReward:50,condition:e=>e.premiumTriviaAnswered>=1},premium_trivia_25:{id:"premium_trivia_25",name:"üìö Esoteric Student",description:"Answer 25% of premium questions (27/108)",category:"Premium Trivia",xpReward:200,condition:e=>e.premiumTriviaAnswered>=27},premium_trivia_50:{id:"premium_trivia_50",name:"üîÆ Mystic Scholar",description:"Answer 50% of premium questions (54/108)",category:"Premium Trivia",xpReward:500,condition:e=>e.premiumTriviaAnswered>=54},premium_trivia_75:{id:"premium_trivia_75",name:"‚ú® Adept Initiate",description:"Answer 75% of premium questions (81/108)",category:"Premium Trivia",xpReward:1e3,condition:e=>e.premiumTriviaAnswered>=81},premium_trivia_100:{id:"premium_trivia_100",name:"üëë Enlightened Master",description:"Complete all 108 premium questions",category:"Premium Trivia",xpReward:2e3,condition:e=>e.premiumTriviaAnswered>=108},premium_kabbalah:{id:"premium_kabbalah",name:"üîØ Kabbalist",description:"Master all Kabbalah questions (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.kabbalah>=9},premium_enochian:{id:"premium_enochian",name:"üëÅÔ∏è Enochian Adept",description:"Master all Enochian Mysteries (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.enochian>=9},premium_gnostic:{id:"premium_gnostic",name:"üêç Gnostic Sage",description:"Master all Gnostic Wisdom (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.gnostic>=9},premium_geometry:{id:"premium_geometry",name:"üî∫ Sacred Geometer",description:"Master all Sacred Geometry (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.sacred_geometry>=9},premium_biblical:{id:"premium_biblical",name:"üìú Code Breaker",description:"Master all Hidden Biblical Codes (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.biblical_codes>=9},premium_consciousness:{id:"premium_consciousness",name:"üß† Consciousness Engineer",description:"Master all Consciousness Technology (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.consciousness>=9},premium_mystery_schools:{id:"premium_mystery_schools",name:"üèõÔ∏è Mystery Initiate",description:"Master all Mystery Schools (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.mystery_schools>=9},premium_chakras:{id:"premium_chakras",name:"üåà Energy Master",description:"Master all Chakras & Energy (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.chakras>=9},premium_alchemy:{id:"premium_alchemy",name:"üß™ Alchemist",description:"Master all Alchemy & Transformation (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.alchemy>=9},premium_astrotheology:{id:"premium_astrotheology",name:"‚≠ê Astrotheologian",description:"Master all Astrotheology (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.astrotheology>=9},premium_divine_feminine:{id:"premium_divine_feminine",name:"üåô Divine Feminine Sage",description:"Master all Divine Feminine Mysteries (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.divine_feminine>=9},premium_numerology:{id:"premium_numerology",name:"üî¢ Sacred Numerologist",description:"Master all Sacred Numerology (9/9)",category:"Premium Trivia",xpReward:300,condition:e=>e.premiumCategories?.sacred_numerology>=9},premium_seeker_master:{id:"premium_seeker_master",name:"üå± Seeker Complete",description:"Answer all 36 Seeker-level questions",category:"Premium Trivia",xpReward:400,condition:e=>e.premiumDifficulty?.seeker>=36},premium_initiate_master:{id:"premium_initiate_master",name:"üî• Initiate Complete",description:"Answer all 36 Initiate-level questions",category:"Premium Trivia",xpReward:600,condition:e=>e.premiumDifficulty?.initiate>=36},premium_adept_master:{id:"premium_adept_master",name:"üíé Adept Complete",description:"Answer all 36 Adept-level questions",category:"Premium Trivia",xpReward:1e3,condition:e=>e.premiumDifficulty?.adept>=36},premium_perfect_first:{id:"premium_perfect_first",name:"‚≠ê Premium Perfect",description:"Get your first perfect category (9/9)",category:"Premium Trivia",xpReward:250,condition:e=>e.premiumPerfectCategories>=1},premium_perfect_all:{id:"premium_perfect_all",name:"üèÜ Absolute Mastery",description:"Perfect score on all 12 categories",category:"Premium Trivia",xpReward:5e3,condition:e=>e.premiumPerfectCategories>=12},match_first_game:{id:"match_first_game",name:"üéÆ Memory Awakened",description:"Complete your first matching game",category:"Matching",xpReward:50,condition:e=>e.matchingGamesPlayed>=1},match_etymology_master:{id:"match_etymology_master",name:"üìú Etymology Master",description:"Complete 10 Biblical Etymology games",category:"Matching",xpReward:300,condition:e=>e.etymologyGames>=10},match_names_scholar:{id:"match_names_scholar",name:"üëë Names Scholar",description:"Complete 10 Hebrew Names games",category:"Matching",xpReward:300,condition:e=>e.namesGames>=10},match_numbers_sage:{id:"match_numbers_sage",name:"üî¢ Numbers Sage",description:"Complete 10 Sacred Numbers games",category:"Matching",xpReward:300,condition:e=>e.numbersGames>=10},match_perfect_hard:{id:"match_perfect_hard",name:"üíé Flawless Memory",description:"Perfect score on Hard mode matching",category:"Matching",xpReward:500,condition:e=>e.matchingPerfectHard>=1},level_5_seeker:{id:"level_5_seeker",name:"üåü Seeker",description:"Reach Level 5",category:"Progression",xpReward:50,condition:e=>e.level>=5,unlock:"First knowledge unlock free"},level_10_scholar:{id:"level_10_scholar",name:"üìö Scholar",description:"Reach Level 10",category:"Progression",xpReward:100,condition:e=>e.level>=10,unlock:"1 free knowledge guide"},level_15_teacher:{id:"level_15_teacher",name:"üë®‚Äçüè´ Teacher",description:"Reach Level 15",category:"Progression",xpReward:150,condition:e=>e.level>=15},level_21_nazarite:{id:"level_21_nazarite",name:"üî• Nazarite",description:"Reach Level 21 (Age of Consecration)",category:"Progression",xpReward:210,condition:e=>e.level>=21,unlock:"Special Nazarite badge + theme"},level_30_sage:{id:"level_30_sage",name:"üïé Sage",description:"Reach Level 30",category:"Progression",xpReward:300,condition:e=>e.level>=30,unlock:"All basic shop items unlocked"},level_40_elder:{id:"level_40_elder",name:"üë¥ Elder",description:"Reach Level 40 (Completion)",category:"Progression",xpReward:400,condition:e=>e.level>=40,unlock:"Custom title creation"},level_50_master:{id:"level_50_master",name:"üéì Master Teacher",description:"Reach Level 50 (Divine Jubilee)",category:"Progression",xpReward:500,condition:e=>e.level>=50,unlock:"All content unlocked"},xp_1000:{id:"xp_1000",name:"üí∞ First Thousand",description:"Earn 1,000 total XP",category:"XP",xpReward:100,condition:e=>e.totalXP>=1e3},xp_5000:{id:"xp_5000",name:"üíé Five Thousand",description:"Earn 5,000 total XP",category:"XP",xpReward:500,condition:e=>e.totalXP>=5e3},xp_10000:{id:"xp_10000",name:"üëë Ten Thousand",description:"Earn 10,000 total XP",category:"XP",xpReward:1e3,condition:e=>e.totalXP>=1e4},ya_heard_me:{id:"ya_heard_me",name:"‚ö° Ya Heard Me",description:"Complete all theological teaching games",category:"Special",xpReward:2e3,condition:e=>e.etymologyGames>=10&&e.namesGames>=10&&e.numbersGames>=10&&e.triviaPerfectScores>=5},truth_awakened:{id:"truth_awakened",name:"‚ú® Truth Awakened",description:"Purchase all knowledge unlocks",category:"Special",xpReward:1500,condition:e=>e.knowledgeUnlocked>=6}},this.dailyQuests=[{id:"daily_trivia",name:"Daily Wisdom",description:"Complete today's trivia with 4/5 correct",xpReward:50,condition:e=>e.todayTriviaScore>=4},{id:"daily_match",name:"Memory Practice",description:"Play 1 matching game",xpReward:50,condition:e=>e.todayMatchingGames>=1},{id:"daily_explorer",name:"Temple Explorer",description:"Visit 3 different temple sections",xpReward:30,condition:e=>e.todaySectionsVisited>=3},{id:"daily_share",name:"Spread the Light",description:"Share your progress on social",xpReward:20,condition:e=>e.todayShared>=1}],this.weeklyQuests=[{id:"weekly_perfect",name:"Week of Perfection",description:"Get perfect score on Hard mode matching",xpReward:200,condition:e=>e.weekPerfectHard>=1},{id:"weekly_streak",name:"Devoted Scholar",description:"Complete 7-day trivia streak",xpReward:300,condition:e=>e.triviaStreak>=7},{id:"weekly_themes",name:"Theme Master",description:"Complete all 4 matching themes this week",xpReward:400,condition:e=>e.weekThemesCompleted>=4},{id:"weekly_unlock",name:"Knowledge Seeker",description:"Unlock 1 new reward item",xpReward:150,condition:e=>e.weekItemsUnlocked>=1}],this.init()}async init(){console.log("üèÜ Initializing Achievement System..."),"undefined"!=typeof firebase&&firebase.auth?firebase.auth().onAuthStateChanged(async e=>{this.currentUser=e,e?await this.loadAchievementData():this.loadLocalData(),this.isInitialized=!0,console.log("‚úÖ Achievement System ready")}):(this.loadLocalData(),this.isInitialized=!0,console.log("‚úÖ Achievement System ready (local mode)"))}async loadAchievementData(){if(this.currentUser)try{const e=firebase.firestore(),i=await e.collection("achievements").doc(this.currentUser.uid).get();i.exists?this.achievementData=i.data():(this.achievementData=this.getDefaultData(),await this.saveData())}catch(e){console.error("Error loading achievement data:",e),this.loadLocalData()}}loadLocalData(){const e=localStorage.getItem("achievementData");e?this.achievementData=JSON.parse(e):(this.achievementData=this.getDefaultData(),this.saveLocalData())}getDefaultData(){return{unlockedAchievements:[],triviaCompleted:0,triviaPerfectScores:0,triviaStreak:0,matchingGamesPlayed:0,etymologyGames:0,namesGames:0,numbersGames:0,matchingPerfectHard:0,premiumTriviaAnswered:0,premiumTriviaCorrect:0,premiumPerfectCategories:0,premiumCategories:{kabbalah:0,enochian:0,gnostic:0,sacred_geometry:0,biblical_codes:0,consciousness:0,mystery_schools:0,chakras:0,alchemy:0,astrotheology:0,divine_feminine:0,sacred_numerology:0},premiumDifficulty:{seeker:0,initiate:0,adept:0},premiumAnsweredQuestions:[],level:1,totalXP:0,knowledgeUnlocked:0,todayTriviaScore:0,todayMatchingGames:0,todaySectionsVisited:0,todayShared:0,weekPerfectHard:0,weekThemesCompleted:0,weekItemsUnlocked:0,completedDailyQuests:[],completedWeeklyQuests:[],lastDailyReset:null,lastWeeklyReset:null}}async saveData(){if(this.currentUser&&"undefined"!=typeof firebase)try{const e=firebase.firestore();await e.collection("achievements").doc(this.currentUser.uid).set(this.achievementData)}catch(e){console.error("Error saving achievement data:",e)}this.saveLocalData()}saveLocalData(){localStorage.setItem("achievementData",JSON.stringify(this.achievementData))}async checkAchievements(e){if(!this.achievementData)return[];const i=[],t={...this.achievementData,...e};for(const[e,a]of Object.entries(this.achievements))this.achievementData.unlockedAchievements.includes(a.id)||a.condition(t)&&(i.push(a),this.achievementData.unlockedAchievements.push(a.id),window.progressSystem&&a.xpReward&&await window.progressSystem.awardXP(a.xpReward,`Achievement: ${a.name}`,"achievement"));return i.length>0&&(await this.saveData(),this.showAchievementNotifications(i)),i}async checkDailyQuests(e){this.resetDailyQuestsIfNeeded();const i=[],t={...this.achievementData,...e};for(const e of this.dailyQuests)this.achievementData.completedDailyQuests.includes(e.id)||e.condition(t)&&(i.push(e),this.achievementData.completedDailyQuests.push(e.id),window.progressSystem&&e.xpReward&&await window.progressSystem.awardXP(e.xpReward,`Daily Quest: ${e.name}`,"daily_quest"));return i.length>0&&await this.saveData(),i}async checkWeeklyQuests(e){this.resetWeeklyQuestsIfNeeded();const i=[],t={...this.achievementData,...e};for(const e of this.weeklyQuests)this.achievementData.completedWeeklyQuests.includes(e.id)||e.condition(t)&&(i.push(e),this.achievementData.completedWeeklyQuests.push(e.id),window.progressSystem&&e.xpReward&&await window.progressSystem.awardXP(e.xpReward,`Weekly Quest: ${e.name}`,"weekly_quest"));return i.length>0&&await this.saveData(),i}resetDailyQuestsIfNeeded(){const e=(new Date).toDateString();this.achievementData.lastDailyReset!==e&&(this.achievementData.completedDailyQuests=[],this.achievementData.todayTriviaScore=0,this.achievementData.todayMatchingGames=0,this.achievementData.todaySectionsVisited=0,this.achievementData.todayShared=0,this.achievementData.lastDailyReset=e)}resetWeeklyQuestsIfNeeded(){const e=new Date,i=new Date(e.setDate(e.getDate()-e.getDay())).toDateString();this.achievementData.lastWeeklyReset!==i&&(this.achievementData.completedWeeklyQuests=[],this.achievementData.weekPerfectHard=0,this.achievementData.weekThemesCompleted=0,this.achievementData.weekItemsUnlocked=0,this.achievementData.lastWeeklyReset=i)}showAchievementNotifications(e){e.forEach((e,i)=>{setTimeout(()=>{this.showNotification(e)},2e3*i)})}showNotification(e){const i=document.createElement("div");if(i.className="achievement-notification",i.innerHTML=`\n            <div class="achievement-icon">${e.name.split(" ")[0]}</div>\n            <div class="achievement-content">\n                <div class="achievement-title">Achievement Unlocked!</div>\n                <div class="achievement-name">${e.name}</div>\n                <div class="achievement-xp">+${e.xpReward} XP</div>\n            </div>\n        `,!document.getElementById("achievement-notification-styles")){const e=document.createElement("style");e.id="achievement-notification-styles",e.textContent="\n                .achievement-notification {\n                    position: fixed;\n                    top: 20px;\n                    right: 20px;\n                    background: linear-gradient(135deg, #D4AF37, #8B5CF6);\n                    color: white;\n                    padding: 1.5rem;\n                    border-radius: 15px;\n                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n                    display: flex;\n                    gap: 1rem;\n                    align-items: center;\n                    z-index: 10000;\n                    animation: slideIn 0.5s ease, slideOut 0.5s ease 4.5s;\n                }\n\n                @keyframes slideIn {\n                    from {\n                        transform: translateX(400px);\n                        opacity: 0;\n                    }\n                    to {\n                        transform: translateX(0);\n                        opacity: 1;\n                    }\n                }\n\n                @keyframes slideOut {\n                    from {\n                        transform: translateX(0);\n                        opacity: 1;\n                    }\n                    to {\n                        transform: translateX(400px);\n                        opacity: 0;\n                    }\n                }\n\n                .achievement-icon {\n                    font-size: 3rem;\n                }\n\n                .achievement-title {\n                    font-size: 0.85rem;\n                    opacity: 0.9;\n                    text-transform: uppercase;\n                    letter-spacing: 1px;\n                }\n\n                .achievement-name {\n                    font-size: 1.2rem;\n                    font-weight: 700;\n                    margin-top: 0.25rem;\n                }\n\n                .achievement-xp {\n                    font-size: 0.95rem;\n                    color: #FFD700;\n                    margin-top: 0.25rem;\n                }\n            ",document.head.appendChild(e)}document.body.appendChild(i),setTimeout(()=>{i.remove()},5e3),window.audioSystem&&window.audioSystem.playSound("achievement")}getProgress(){return this.achievementData}getUnlockedAchievements(){return this.achievementData?.unlockedAchievements||[]}getDailyQuestsProgress(){return this.resetDailyQuestsIfNeeded(),{quests:this.dailyQuests,completed:this.achievementData?.completedDailyQuests||[]}}getWeeklyQuestsProgress(){return this.resetWeeklyQuestsIfNeeded(),{quests:this.weeklyQuests,completed:this.achievementData?.completedWeeklyQuests||[]}}}document.addEventListener("DOMContentLoaded",()=>{console.log("üèÜ Initializing Achievement System..."),window.achievementSystem=new AchievementSystem});